{"version":3,"sources":["Home/UserContext.tsx","Boiler/NavBarProfile.tsx","Boiler/NavBar.tsx","Boiler/Header.tsx","Boiler/Footer.tsx","UserAuth/Login.tsx","Thread/AddPost.tsx","Thread/Post/PostHeader.tsx","Thread/CommunityContext.tsx","Thread/Post/PostFooter.tsx","Thread/Post/PostBody.tsx","Home/PostContext.tsx","Thread/Post/PostVotes.tsx","Thread/Post/Post.tsx","GenericComponents/OverlayComponent.tsx","Community/Admin/AdminPanel.tsx","Community/CommunityBanner.tsx","Thread/Thread.tsx","UserAuth/Register.tsx","Community/AddThread.tsx","Community/ThreadCard.tsx","Community/Home.tsx","Home/AddCommunity.tsx","Home/MainPage.tsx","App.tsx","index.js"],"names":["UserContext","createContext","NavBarProfile","server","process","useContext","username","setUsername","history","useHistory","location","useLocation","a","undefined","sessionID","localStorage","getItem","fetch","result","json","jsoned","includes","pathname","push","useEffect","mounted","removeItem","getUsername","className","to","onClick","length","renderRegister","NavBar","Header","Footer","style","position","bottom","Login","useState","password","setPassword","status","setStatus","setUsernameAlias","e","preventDefault","obj","body","JSON","stringify","headers","method","response","hasOwnProperty","error","setItem","type","value","onChange","target","placeholder","AddPost","threadID","noRenderButton","loadThread","parentPostID","setRenderReplyForm","addPostOn","setAddPostOn","content","setContent","imageURL","setImageURL","makePost","post","date","Date","getTime","toString","childrenIDs","parentID","current","cancelHandler","rows","PostHeader","timeSince","setTimeSince","timer","setInterval","time","parseInt","clearTimeout","prettyMS","compact","CommunityContext","PostFooter","renderChildren","setRenderChildren","deletePost","community","postID","id","hidden","resp","toggleReplies","hidePostServerSide","cursor","prev","deleted","admins","deletePostButton","PostBody","wordBreak","maxWidth","width","height","src","alt","renderImage","PostContext","PostVotes","votes","setVotes","userVote","setUserVote","voteReload","postToReload","setPostToReload","getVotes","usersVote","jsonedvote","vote","payload","Provider","size","color","marginBottom","Post","getPost","indentLevel","newPost","postNotProp","setPostNotProp","childrenPosts","setChildrenPosts","renderReplyForm","newPostObj","setNewPostObj","deleteReload","deletedPost","setDeletedPost","padding","retrievePost","result2","updatedpost","console","log","r","loadPost","updatedPost","marginLeft","paddingLeft","renderReply","map","OverlayComponent","props","minWidth","children","SERVER","AdminPanel","setReload","renderEditCommunity","setRenderEditCommunity","newAdmins","setNewAdmins","description","newDescription","setNewDescription","newAdminsString","setNewAdminsString","submit","communityName","addNewAdmin","newAdmin","renderEditAdminsForm","admin","adminToBeRemoved","currentTarget","innerText","copy","index","indexOf","splice","removeAdmin","editCommunity","defaultCommunity","_id","creatorUsername","CommunityBanner","setCommunityName","setCommunity","reload","params","useParams","dateMS","toLocaleDateString","msToDate","renderAdminPanel","socket","io","defaultThread","title","posts","Thread","thread","setThread","hist","topLevelPosts","setTopLevelPosts","res","deleteThread","getPostByID","connect","emit","on","disconnect","renderOwnerActions","wordWrap","Register","confirmPassword","setConfirmPassword","setError","checkPasswordsSame","Promise","setTimeout","registerUser","AddThread","addThreadOn","setAddThreadOn","setTitle","checkThreadValidity","makeThread","errorMessage","ThreadCard","verbose","substring","Home","threads","setThreads","newThread","filter","x","renderError","AddCommunity","addCommunity","addCommunityOn","setAddCommunityOn","setDescription","makeCommunity","newCommunity","Mainpage","communitites","setCommunities","searchValue","setSearchValue","renderedCommunities","setRenderedCommunities","searchCommunities","searchText","results","Fuzzy","extract","item","string","smallCommunityStub","currentCommunites","c","App","basename","path","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.861b1946.chunk.js","sourcesContent":["import { createContext } from \"react\";\r\n\r\nexport const UserContext = createContext<any>(null);\r\n","import { useContext } from \"react\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { Link, useHistory, useLocation } from \"react-router-dom\";\r\nimport { UserContext } from \"../Home/UserContext\";\r\n\r\nconst NavBarProfile = () => {\r\n  const server = process.env.REACT_APP_API_SERVER;\r\n  const { username, setUsername } = useContext(UserContext);\r\n  const history = useHistory();\r\n  const location = useLocation();\r\n\r\n  async function getUsername() {\r\n    const sessionID = localStorage.getItem(\"sessionID\");\r\n\r\n    if (sessionID === undefined) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const result = await fetch(server + \"getUsername/\" + sessionID);\r\n      const jsoned = await result.json();\r\n      // redirect to login if not logged in\r\n      if (\r\n        !jsoned.username &&\r\n        ![\"/login\", \"/register\"].includes(location.pathname)\r\n      ) {\r\n        history.push(\"/login\");\r\n        return;\r\n      }\r\n      setUsername(jsoned.username);\r\n    } catch (error) {\r\n      history.push(\"/login\");\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    // explicitly redirect to login for all non specified routes\r\n    if (location.pathname === \"/\" || location.pathname === \"/login\") {\r\n      localStorage.removeItem(\"sessionID\");\r\n      history.push(\"/login\");\r\n      if (mounted) {\r\n        setUsername(\"\");\r\n      }\r\n      return;\r\n    }\r\n\r\n    getUsername();\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n  }, [location.pathname]);\r\n\r\n  /** Logs the user out. */\r\n  function logout() {\r\n    localStorage.removeItem(\"sessionID\");\r\n    setUsername(\"\");\r\n  }\r\n\r\n  /** Render logout button if logged in */\r\n  function renderLogoutConditionally() {\r\n    // if logged in\r\n    if (username && username.length > 0) {\r\n      return <h5 className=\"text-primary\">logout</h5>;\r\n    }\r\n\r\n    if (location.pathname === \"/register\") {\r\n      return <h5>Login</h5>;\r\n    }\r\n  }\r\n\r\n  /** Render Register button if not logged in */\r\n  function renderRegister() {\r\n    if (location.pathname === \"/register\") {\r\n      return;\r\n    }\r\n\r\n    // if logged out and not on register page\r\n    if (!username) {\r\n      return <h5 className=\"font-weight-bold\">Register</h5>;\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h6 className=\"text-white\">{username}</h6>\r\n      <div className=\"d-flex flex-row\">\r\n        <Link className=\"mr-3\" to=\"/login\" onClick={logout}>\r\n          {renderLogoutConditionally()}\r\n        </Link>\r\n        <Link to=\"/register\">{renderRegister()}</Link>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NavBarProfile;\r\n","import { Link } from \"react-router-dom\";\r\nimport NavBarProfile from \"./NavBarProfile\";\r\n\r\nconst NavBar = () => {\r\n  /** Returns where the home button should redirect to. */\r\n  function allowedUrl(): string {\r\n    if (localStorage.getItem(\"sessionID\") === null) {\r\n      return \"#\";\r\n    }\r\n    return \"/home\";\r\n  }\r\n  return (\r\n    <div className=\"bg-dark navbar w-100 static-top\">\r\n      <Link to={allowedUrl}>\r\n        <h1 className=\"navbar-brand mx-3 text-light\">Forum Clone</h1>\r\n      </Link>\r\n\r\n      <NavBarProfile />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NavBar;\r\n","import NavBar from \"./NavBar\";\r\nimport { createContext, useState } from \"react\";\r\n\r\n// interface UserContextType {\r\n//   username: string | null;\r\n//   setUsername: React.Dispatch<React.SetStateAction<string>>;\r\n// }\r\n\r\nconst Header = () => {\r\n  return (\r\n    <div>\r\n      <NavBar />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Header;\r\n","const Footer = () => {\r\n  return (\r\n    <div className=\"bg-dark w-100\" style={{ position: \"fixed\", bottom: 0 }}>\r\n      <h6 className=\"text-light m-2\">Dom Zhu - 2021</h6>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Footer;\r\n","import React, { useState, useContext, useEffect } from \"react\";\r\nimport { useHistory, Link, useLocation } from \"react-router-dom\";\r\nimport { UserContext } from \"../Home/UserContext\";\r\n\r\nconst Login: React.FC = () => {\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [status, setStatus] = useState(\"\");\r\n  const history = useHistory();\r\n  const usernameAlias = useContext(UserContext).username;\r\n  const setUsernameAlias = useContext(UserContext).setUsername;\r\n\r\n  const location = useLocation();\r\n  const server = process.env.REACT_APP_API_SERVER;\r\n\r\n  /** Logs the user in. */\r\n  async function login(e: React.MouseEvent) {\r\n    e.preventDefault();\r\n\r\n    const obj = {\r\n      username: username,\r\n      password: password,\r\n    };\r\n\r\n    // send off to server\r\n    const url = server + \"login\";\r\n    try {\r\n      const result = await fetch(url, {\r\n        body: JSON.stringify(obj),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        method: \"POST\",\r\n      });\r\n      const response = await result.json();\r\n\r\n      if (response.hasOwnProperty(\"error\")) {\r\n        setStatus(response.error);\r\n        return;\r\n      }\r\n      localStorage.setItem(\"sessionID\", response.sessionID);\r\n\r\n      // username already used locally, so need different var name\r\n      setUsernameAlias(username);\r\n      history.push(\"/home\");\r\n    } catch (err) {\r\n      setStatus(\"Failed to login. Please try again.\");\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    setUsernameAlias(\"\");\r\n    if (location.pathname !== \"/login\") {\r\n      history.push(\"/login\");\r\n    }\r\n  }, [location.pathname, history, setUsernameAlias]);\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"row\">\r\n        <div className=\"col-12 col-sm-8 offset-sm-2 col-xl-6 offset-xl-3\">\r\n          <form className=\"mt-5\">\r\n            <h1 className=\"mb-4 text-center\">Login</h1>\r\n            <div className=\"form-group mb-2\">\r\n              <label>Username</label>\r\n              <input\r\n                type=\"text\"\r\n                value={username}\r\n                onChange={(e) => setUsername(e.target.value)}\r\n                className=\"form-control\"\r\n                placeholder=\"Enter username\"\r\n              />\r\n            </div>\r\n            <div className=\"form-group mb-3\">\r\n              <label>Password</label>\r\n              <input\r\n                type=\"password\"\r\n                value={password}\r\n                onChange={(e) => setPassword(e.target.value)}\r\n                className=\"form-control\"\r\n                placeholder=\"Enter password\"\r\n              />\r\n            </div>\r\n            <button type=\"submit\" onClick={login} className=\"btn btn-primary\">\r\n              Submit\r\n            </button>\r\n          </form>\r\n          <Link to=\"/register\">\r\n            <div className=\"mt-1\">New user? Click here to register!</div>\r\n          </Link>\r\n          {status.length > 0 && (\r\n            <h5 className=\"mt-3 alert alert-danger\">{status}</h5>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n","import { useState, useContext, useEffect } from \"react\";\r\nimport { UserContext } from \"../Home/UserContext\";\r\n\r\ninterface Props {\r\n  // the current thread's ID\r\n  threadID: string;\r\n  loadThread: () => void;\r\n\r\n  // if false, then don't render the add post button\r\n  noRenderButton?: boolean;\r\n\r\n  // when in reply mode\r\n  parentPostID?: string;\r\n\r\n  // so we can remove the reply form component when post submitted\r\n  setRenderReplyForm?: React.Dispatch<React.SetStateAction<boolean>>;\r\n}\r\n\r\ninterface PostRequest {\r\n  username: string;\r\n  content: string;\r\n  date: string;\r\n  threadID: string;\r\n  childrenIDs: string[]; // TODO maybe make server side\r\n  parentID?: string;\r\n  imageURL: string;\r\n}\r\n\r\nconst AddPost = ({\r\n  threadID,\r\n  loadThread,\r\n  noRenderButton,\r\n  parentPostID,\r\n  setRenderReplyForm,\r\n}: Props) => {\r\n  const [addPostOn, setAddPostOn] = useState<boolean>(false);\r\n  const server = process.env.REACT_APP_API_SERVER;\r\n  const [content, setContent] = useState<string>(\"\");\r\n  const { username } = useContext(UserContext);\r\n  const [imageURL, setImageURL] = useState<string>(\"\");\r\n\r\n  useEffect(() => {\r\n    if (noRenderButton === undefined) {\r\n      setAddPostOn(false);\r\n    } else {\r\n      setAddPostOn(true);\r\n    }\r\n  }, []);\r\n\r\n  /** Makes a post to the server */\r\n  async function makePost() {\r\n    // console.log(new Date().getTime().toString());\r\n    const post: PostRequest = {\r\n      username: username, // username temp\r\n      content: content,\r\n      date: new Date().getTime().toString(),\r\n      threadID: threadID,\r\n      childrenIDs: [],\r\n      parentID: parentPostID, // TODO if not reply, then parentID is ''\r\n      imageURL: imageURL,\r\n    };\r\n\r\n    try {\r\n      const result = await fetch(server + \"makePost\", {\r\n        body: JSON.stringify(post),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        method: \"POST\",\r\n      });\r\n      const response = await result.json();\r\n      // loadThread();\r\n      setAddPostOn((current) => !current);\r\n      setContent(\"\");\r\n      setImageURL(\"\");\r\n    } catch (error) {\r\n      // TODO error handling\r\n      return;\r\n    }\r\n\r\n    cancelHandler();\r\n  }\r\n\r\n  /** Closes the form. */\r\n  function cancelHandler() {\r\n    setAddPostOn(false);\r\n    if (setRenderReplyForm) {\r\n      setRenderReplyForm(false);\r\n    }\r\n  }\r\n\r\n  /** Renders the add post form. */\r\n  function renderForm() {\r\n    return (\r\n      <div className=\"form-group mt-4 mb-5\">\r\n        <label className=\"\">Content</label>\r\n        <textarea\r\n          value={content}\r\n          placeholder=\"What are your thoughts?\"\r\n          onChange={(e) => setContent(e.target.value)}\r\n          className=\"form-control border border-secondary\"\r\n          rows={6}\r\n        />\r\n        <div className=\"mt-3\">\r\n          <label>Image url</label>\r\n          <input\r\n            value={imageURL}\r\n            type=\"text\"\r\n            onChange={(e) => setImageURL(e.target.value)}\r\n            className=\"form-control border border-secondary\"\r\n          />\r\n        </div>\r\n        <div className=\"d-flex flex-row justify-content-end\">\r\n          <button\r\n            onClick={(e) => cancelHandler()}\r\n            className=\"btn btn-primary mt-2\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            onClick={makePost}\r\n            className=\"btn btn-primary mt-2 ml-3 bg-secondary text-dark border border-secondary\"\r\n          >\r\n            Submit\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /** Renders the add post button. */\r\n  function renderButton() {\r\n    return (\r\n      <div>\r\n        <button\r\n          className=\"btn btn-primary\"\r\n          onClick={() => setAddPostOn((current) => !current)}\r\n        >\r\n          Add Reply\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {addPostOn && renderForm()}\r\n      {!addPostOn && !noRenderButton && renderButton()}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AddPost;\r\n","import { PostObj } from \"../Thread\";\r\nimport prettyMS from \"pretty-ms\";\r\nimport { useState, useEffect } from \"react\";\r\ninterface Props {\r\n  post: PostObj;\r\n}\r\n\r\nconst PostHeader = ({ post }: Props) => {\r\n  const [timeSince, setTimeSince] = useState<number>(0);\r\n\r\n  useEffect(() => {\r\n    let timer = setInterval(() => {\r\n      const time = new Date().getTime() - parseInt(post.date);\r\n\r\n      setTimeSince(time);\r\n    }, 100);\r\n\r\n    // cleanup\r\n    return () => {\r\n      clearTimeout(timer);\r\n    };\r\n  }, [post.date]);\r\n  // continuously update how long ago the post was made\r\n\r\n  return (\r\n    <div className=\"row p-2 d-flex justify-content-between\">\r\n      <h6 className=\"text-white ml-1\">{post.username}</h6>\r\n      <h6>\r\n        {post.date !== \"1\" && (\r\n          <small className=\"ml-3 text-muted\">\r\n            {prettyMS(timeSince, { compact: true })} ago\r\n          </small>\r\n        )}\r\n      </h6>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PostHeader;\r\n","import { createContext } from \"react\";\r\n\r\nexport const CommunityContext = createContext<any>(null);\r\n","import { PostObj } from \"../Thread\";\r\nimport { UserContext } from \"../../Home/UserContext\";\r\nimport { useContext } from \"react\";\r\n\r\nimport { CommunityContext } from \"../CommunityContext\";\r\nimport { CommunityBannerObj } from \"../../Community/CommunityBanner\";\r\ninterface Props {\r\n  post: PostObj;\r\n  renderChildren: boolean;\r\n  setRenderReplyForm: React.Dispatch<React.SetStateAction<boolean>>;\r\n  setRenderChildren: React.Dispatch<React.SetStateAction<boolean>>;\r\n  deletePost: () => void;\r\n}\r\n\r\nconst PostFooter = ({\r\n  post,\r\n  renderChildren,\r\n  setRenderReplyForm,\r\n  setRenderChildren,\r\n  deletePost,\r\n}: Props) => {\r\n  const username = useContext(UserContext).username;\r\n  const server = process.env.REACT_APP_API_SERVER;\r\n  const community: CommunityBannerObj = useContext(CommunityContext);\r\n\r\n  /** Hides the post for the user. */\r\n  async function hidePostServerSide() {\r\n    const resp = await fetch(server + \"hidePost\", {\r\n      body: JSON.stringify({\r\n        username: username,\r\n        postID: post.id,\r\n        hidden: renderChildren,\r\n      }),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      method: \"POST\",\r\n    });\r\n    const jsoned = await resp.json();\r\n    // console.log(jsoned);\r\n  }\r\n\r\n  /** Hides replies from the post which was clicked */\r\n  function toggleReplies() {\r\n    setRenderChildren((current) => !current);\r\n    hidePostServerSide();\r\n    // console.log(username);\r\n    return;\r\n  }\r\n\r\n  /** the reply button */\r\n  function replyButton() {\r\n    return (\r\n      <div>\r\n        <h6 className=\"text-muted\">\r\n          <small\r\n            style={{ cursor: \"pointer\" }}\r\n            onClick={(e) => setRenderReplyForm((prev) => !prev)}\r\n          >\r\n            Reply\r\n          </small>\r\n        </h6>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /** the show / hide reply button */\r\n  function showHideReplyButton() {\r\n    // dont render if no children\r\n    if (post.childrenIDs.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <div className={\"ml-3\"}>\r\n        <h6 className=\"text-muted\">\r\n          <small style={{ cursor: \"pointer\" }} onClick={(e) => toggleReplies()}>\r\n            {!renderChildren && \"Show Replies\"}\r\n            {renderChildren && \"Hide Replies\"}\r\n          </small>\r\n        </h6>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /** the delete post button */\r\n  function deletePostButton() {\r\n    // only render if post isn't already deleted\r\n    if (post.deleted) {\r\n      return;\r\n    }\r\n\r\n    // only delete your own posts // TODO fix server side\r\n    if (post.username !== username && !community.admins.includes(username)) {\r\n      return;\r\n    }\r\n\r\n    return (\r\n      <div className={\"ml-3\"}>\r\n        <h6 className=\"text-muted\">\r\n          <small style={{ cursor: \"pointer\" }} onClick={(e) => deletePost()}>\r\n            Delete Post\r\n          </small>\r\n        </h6>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"row\">\r\n      <div className=\"col d-flex\">\r\n        {replyButton()}\r\n        {showHideReplyButton()}\r\n        {deletePostButton()}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PostFooter;\r\n","import { PostObj } from \"../Thread\";\r\n\r\ninterface Props {\r\n  post: PostObj;\r\n}\r\n\r\nconst PostBody = ({ post }: Props) => {\r\n  /** Renders the image if necessary */\r\n  function renderImage(): JSX.Element | void {\r\n    if (post.deleted) {\r\n      return;\r\n    }\r\n\r\n    if (post.imageURL !== \"\") {\r\n      return (\r\n        <img\r\n          className=\"mb-2\"\r\n          style={{ maxWidth: \"400px\", width: \"100%\", height: \"auto\" }}\r\n          src={post.imageURL}\r\n          alt=\"\"\r\n        />\r\n      );\r\n    }\r\n\r\n    return;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className=\"row pl-2\">\r\n        <div className=\"text-white ml-1\">\r\n          {post.deleted ? (\r\n            <h6 className=\"text-danger\">[Deleted]</h6>\r\n          ) : (\r\n            <p style={{ wordBreak: \"break-word\" }}>{post.content}</p>\r\n          )}\r\n        </div>\r\n      </div>\r\n      {renderImage()}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PostBody;\r\n","import { createContext } from \"react\";\r\n\r\nexport const PostContext = createContext<any>(null);\r\n","import { useState, useEffect, useContext } from \"react\";\r\nimport { IconContext } from \"react-icons\";\r\nimport { IoIosArrowUp, IoIosArrowDown } from \"react-icons/io\";\r\nimport { PostContext } from \"../../Home/PostContext\";\r\n\r\ninterface Props {\r\n  postID: string;\r\n  username: string;\r\n}\r\n\r\nconst PostVotes = ({ postID, username }: Props) => {\r\n  const [votes, setVotes] = useState<number>(0);\r\n  const server = process.env.REACT_APP_API_SERVER;\r\n  const [userVote, setUserVote] = useState<number>(0);\r\n  const voteReload = useContext(PostContext).voteReload;\r\n  const [postToReload, setPostToReload] = voteReload;\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    if (mounted) {\r\n      if (postToReload === postID) {\r\n        // reload post\r\n        getVotes();\r\n        setPostToReload(null);\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n  }, [postToReload]);\r\n\r\n  // get all votes on startup\r\n  useEffect(() => {\r\n    getVotes();\r\n  }, [username]);\r\n\r\n  async function getVotes() {\r\n    if (username === \"\") return;\r\n\r\n    const resp = await fetch(server + \"getPostVotes\", {\r\n      body: JSON.stringify({ postID: postID }),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      method: \"POST\",\r\n    });\r\n    const jsoned = await resp.json();\r\n    setVotes(parseInt(jsoned.votes));\r\n\r\n    // set colour and upvote\r\n    const usersVote = await fetch(server + \"getUsersVotes\", {\r\n      body: JSON.stringify({ postID: postID, username: username }),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      method: \"POST\",\r\n    });\r\n    const jsonedvote = await usersVote.json();\r\n    setUserVote(jsonedvote.vote);\r\n  }\r\n\r\n  /** Upvotes or downvotes post */\r\n  async function vote(vote: string) {\r\n    const payload = {\r\n      postID: postID,\r\n      vote: vote,\r\n      username: username,\r\n    };\r\n\r\n    fetch(server + \"upvotePost\", {\r\n      body: JSON.stringify(payload),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      method: \"POST\",\r\n    });\r\n  }\r\n\r\n  // TODO change hardcoded votes\r\n  return (\r\n    <div className=\"d-flex flex-column mx-2\">\r\n      <IconContext.Provider value={{ size: \"2em\" }}>\r\n        {userVote === 1 && (\r\n          <IoIosArrowUp\r\n            style={{ cursor: \"pointer\", color: \"orange\" }}\r\n            onClick={(e) => vote(\"1\")}\r\n          />\r\n        )}\r\n        {userVote !== 1 && (\r\n          <IoIosArrowUp\r\n            style={{ cursor: \"pointer\" }}\r\n            onClick={(e) => vote(\"1\")}\r\n          />\r\n        )}\r\n\r\n        <h5 className=\"text-white text-center\" style={{ marginBottom: \"0\" }}>\r\n          {votes}\r\n        </h5>\r\n        {userVote === -1 && (\r\n          <IoIosArrowDown\r\n            style={{ cursor: \"pointer\", color: \"blue\" }}\r\n            onClick={(e) => vote(\"-1\")}\r\n          />\r\n        )}\r\n        {userVote !== -1 && (\r\n          <IoIosArrowDown\r\n            style={{ cursor: \"pointer\" }}\r\n            onClick={(e) => vote(\"-1\")}\r\n          />\r\n        )}\r\n      </IconContext.Provider>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PostVotes;\r\n","import { PostObj } from \"../Thread\";\r\nimport AddPost from \"../AddPost\";\r\nimport { useState, useEffect, useContext } from \"react\";\r\nimport PostHeader from \"./PostHeader\";\r\nimport PostFooter from \"./PostFooter\";\r\nimport PostBody from \"./PostBody\";\r\nimport PostVotes from \"./PostVotes\";\r\nimport { UserContext } from \"../../Home/UserContext\";\r\nimport { PostContext } from \"../../Home/PostContext\";\r\n\r\ninterface Props {\r\n  postID: string;\r\n  threadID: string;\r\n  loadThread: () => void;\r\n  getPost: (postID: string) => PostObj | null;\r\n  indentLevel: number;\r\n  newPost: PostObj | null;\r\n}\r\n\r\nconst server = process.env.REACT_APP_API_SERVER;\r\n\r\nconst Post = ({\r\n  postID,\r\n  threadID,\r\n  loadThread,\r\n  getPost,\r\n  indentLevel,\r\n  newPost,\r\n}: Props) => {\r\n  const defaultPost: PostObj = {\r\n    childrenIDs: [],\r\n    content: \"loading...\",\r\n    date: \"1\",\r\n    id: \"\",\r\n    imageURL: \"\",\r\n    parentID: \"\",\r\n    username: \"loading...\",\r\n  };\r\n  const username = useContext(UserContext).username;\r\n\r\n  // TODO fix later\r\n  const [postNotProp, setPostNotProp] = useState<PostObj>(defaultPost);\r\n\r\n  const [childrenPosts, setChildrenPosts] = useState<string[]>([]);\r\n  // determines if the reply form will be rendered\r\n  const [renderReplyForm, setRenderReplyForm] = useState<boolean>(false);\r\n\r\n  // determines if children are rendered\r\n  const [renderChildren, setRenderChildren] = useState<boolean>(true);\r\n  const [newPostObj, setNewPostObj] = useState<PostObj | null>(newPost);\r\n\r\n  const [deletedPost, setDeletedPost] = useContext(PostContext).deleteReload;\r\n\r\n  // how many pixels each indent level is\r\n  const padding = indentLevel * 20;\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    const loadPost = async () => {\r\n      const r = await retrievePost(postID);\r\n      if (mounted) {\r\n        setPostNotProp(r);\r\n        setChildrenPosts(r.childrenIDs);\r\n      }\r\n    };\r\n\r\n    loadPost();\r\n\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (deletedPost === postID) {\r\n      const updatedPost = postNotProp;\r\n      updatedPost.deleted = true;\r\n      setPostNotProp(updatedPost);\r\n      setDeletedPost(null);\r\n    }\r\n  }, [deletedPost]);\r\n\r\n  useEffect(() => {\r\n    if (newPost === null) {\r\n      return;\r\n    }\r\n\r\n    if (newPost.parentID === postID) {\r\n      setChildrenPosts((current) => [...current, newPost.id]);\r\n\r\n      let updatedPost: PostObj = postNotProp;\r\n      updatedPost.childrenIDs = [...postNotProp.childrenIDs, newPost.id];\r\n\r\n      setPostNotProp(updatedPost);\r\n      setNewPostObj(null);\r\n      return;\r\n    }\r\n\r\n    setNewPostObj(newPost);\r\n  }, [newPost]);\r\n\r\n  /** toggles the reply form when reply clicked */\r\n  function renderReply() {\r\n    if (renderReplyForm) {\r\n      return (\r\n        <AddPost\r\n          threadID={threadID}\r\n          loadThread={loadThread}\r\n          noRenderButton={true}\r\n          parentPostID={postNotProp.id}\r\n          setRenderReplyForm={setRenderReplyForm}\r\n        />\r\n      );\r\n    }\r\n  }\r\n\r\n  /** Gets post */\r\n  async function retrievePost(postID: string) {\r\n    const payload = { threadID: threadID, postID: postID };\r\n\r\n    const result = await fetch(server + \"getPost\", {\r\n      body: JSON.stringify(payload),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      method: \"POST\",\r\n    });\r\n    const response: PostObj = await result.json();\r\n    // return response;\r\n\r\n    // get hidden state.\r\n    const result2 = await fetch(server + \"isPostHidden\", {\r\n      body: JSON.stringify({\r\n        username: username,\r\n        postID: postID,\r\n      }),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      method: \"POST\",\r\n    });\r\n    const jsoned = await result2.json();\r\n    // console.log(`post id: ${postID} is hidden: ${jsoned.status}`);\r\n    setRenderChildren(!jsoned.status);\r\n\r\n    // console.log(response);\r\n    return response;\r\n  }\r\n\r\n  /** Deletes a post from the server */\r\n  async function deletePost() {\r\n    const payload = { threadID: threadID, postID: postID };\r\n\r\n    try {\r\n      const result = await fetch(server + \"deletePost\", {\r\n        body: JSON.stringify(payload),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        method: \"POST\",\r\n      });\r\n      const response: Object = await result.json();\r\n      if (response.hasOwnProperty(\"status\")) {\r\n        const updatedpost = await retrievePost(postID);\r\n        setPostNotProp(updatedpost);\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n\r\n  return (\r\n    // card\r\n    <>\r\n      <div style={{ marginLeft: padding, width: \"auto\" }}>\r\n        <div className=\"my-3 d-flex border border-secondary rounded bg-dark\">\r\n          <PostVotes postID={postID} username={username} />\r\n          <div className=\"container\" style={{ paddingLeft: \"0\" }}>\r\n            <PostHeader post={postNotProp} />\r\n            <PostBody post={postNotProp} />\r\n            <PostFooter\r\n              post={postNotProp}\r\n              renderChildren={renderChildren}\r\n              setRenderReplyForm={setRenderReplyForm}\r\n              setRenderChildren={setRenderChildren}\r\n              deletePost={deletePost}\r\n            />\r\n          </div>\r\n        </div>\r\n        {renderReply()}\r\n      </div>\r\n      {/* Recursively render children */}\r\n      {renderChildren &&\r\n        childrenPosts.map((id) => {\r\n          // console.log(childrenPosts.length);\r\n          if (id !== null) {\r\n            return (\r\n              <Post\r\n                key={id}\r\n                loadThread={loadThread}\r\n                postID={id}\r\n                getPost={getPost}\r\n                threadID={threadID}\r\n                indentLevel={indentLevel + 1}\r\n                newPost={newPostObj}\r\n              />\r\n            );\r\n          }\r\n          return null;\r\n        })}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Post;\r\n","import \"../CSS/Overlay.css\";\r\n\r\n/** Renders an overlay on the screen with the children inside. */\r\nconst OverlayComponent = (props: any) => {\r\n  return (\r\n    <div\r\n      className=\"form-group mt-4 container-fluid d-flex justify-content-center align-items-center\"\r\n      id=\"overlay\"\r\n      style={{ cursor: \"auto\" }}\r\n    >\r\n      <div\r\n        className=\"d-flex flex-column bg-secondary justify-content-center w-75 px-5 py-5\"\r\n        style={{ minWidth: \"350px\", maxWidth: \"750px\" }}\r\n      >\r\n        {props.children}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OverlayComponent;\r\n","import { useState } from \"react\";\r\nimport OverlayComponent from \"../../GenericComponents/OverlayComponent\";\r\nimport { Community } from \"../../Home/AddCommunity\";\r\nimport { BsPlusSquare } from \"react-icons/bs\";\r\nimport { useEffect } from \"react\";\r\n\r\ninterface Props {\r\n  community: Community;\r\n  setReload: React.Dispatch<React.SetStateAction<boolean>>;\r\n}\r\n\r\nconst SERVER = process.env.REACT_APP_API_SERVER;\r\n\r\nconst AdminPanel = ({ community, setReload }: Props) => {\r\n  const [renderEditCommunity, setRenderEditCommunity] = useState<boolean>(\r\n    false\r\n  );\r\n  const [newAdmins, setNewAdmins] = useState<string[]>([]);\r\n  const [newDescription, setNewDescription] = useState<string>(\r\n    community.description\r\n  );\r\n  const [newAdminsString, setNewAdminsString] = useState<string>(\"\");\r\n\r\n  useEffect(() => {\r\n    setNewAdmins(community.admins);\r\n    setNewDescription(community.description);\r\n  }, [community]);\r\n\r\n  async function submit() {\r\n    const payload = {\r\n      description: newDescription,\r\n      communityName: community.communityName,\r\n      admins: newAdmins,\r\n    };\r\n    const result = await fetch(SERVER + \"updateCommunity\", {\r\n      body: JSON.stringify(payload),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      method: \"POST\",\r\n    });\r\n    setRenderEditCommunity(false);\r\n    setReload((current) => !current);\r\n  }\r\n\r\n  // renders the save and cancel buttons in the overlay form\r\n  function renderCancelSaveButtons() {\r\n    return (\r\n      <div className=\"d-flex justify-content-end mt-3\">\r\n        <button\r\n          onClick={() => setRenderEditCommunity((current) => !current)}\r\n          className=\"btn btn-primary mt-2 mr-2\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          onClick={submit}\r\n          // todo error checking\r\n          // onClick={makeCommunity}\r\n          className=\"btn btn-outline-primary mt-2\"\r\n        >\r\n          Save\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // adds new admin locally\r\n  function addNewAdmin() {\r\n    const newAdmin = newAdminsString;\r\n    if (newAdmin === \"\") {\r\n      return;\r\n    }\r\n    setNewAdmins((current) => {\r\n      if (!current.includes(newAdmin)) return [...current, newAdmin];\r\n      return current;\r\n    });\r\n    setNewAdminsString(\"\");\r\n  }\r\n\r\n  // removes the clicked on admin\r\n  function removeAdmin(e: React.MouseEvent<HTMLButtonElement, MouseEvent>) {\r\n    e.preventDefault();\r\n\r\n    const adminToBeRemoved = e.currentTarget.innerText;\r\n    setNewAdmins((current) => {\r\n      if (!current.includes(adminToBeRemoved)) return current;\r\n      let copy = [...current];\r\n      const index = copy.indexOf(adminToBeRemoved);\r\n      copy.splice(index, 1);\r\n      return copy;\r\n    });\r\n  }\r\n\r\n  function renderEditAdminsForm() {\r\n    return (\r\n      <div>\r\n        <label className=\"mt-3 text-left\">Admins</label>\r\n        <div className=\"container\">\r\n          <div className=\"border border-secondary p-3 d-flex row\">\r\n            {newAdmins.map((admin) => (\r\n              <button\r\n                className=\"rounded mx-1 btn-outline-danger\"\r\n                key={admin}\r\n                onClick={(e) => removeAdmin(e)}\r\n              >\r\n                {admin}\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n        <label className=\"mt-3 text-left\">Add new admin</label>\r\n        <div className=\"d-flex\">\r\n          <input\r\n            className=\"form-control w-50\"\r\n            style={{ minWidth: \"200px\" }}\r\n            onChange={(e) => setNewAdminsString(e.target.value)}\r\n            value={newAdminsString}\r\n          />\r\n          <BsPlusSquare\r\n            onClick={addNewAdmin}\r\n            className=\"ml-2 \"\r\n            style={{ cursor: \"pointer\" }}\r\n            size={47}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n  function editCommunity() {\r\n    if (!renderEditCommunity) return;\r\n    return (\r\n      <OverlayComponent>\r\n        <h3>Edit Community</h3>\r\n        <div>\r\n          <label className=\"mt-3 text-left\">Description</label>\r\n          <textarea\r\n            className=\"form-control\"\r\n            onChange={(e) => setNewDescription(e.target.value)}\r\n            rows={8}\r\n            value={newDescription}\r\n          />\r\n        </div>\r\n        {renderEditAdminsForm()}\r\n        {renderCancelSaveButtons()}\r\n      </OverlayComponent>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"d-flex flex-column\">\r\n      <h4>Admin panel</h4>\r\n      <button\r\n        className=\"btn btn-primary p-1 mb-2\"\r\n        onClick={() => setRenderEditCommunity((current) => !current)}\r\n      >\r\n        Edit community\r\n      </button>\r\n      {editCommunity()}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminPanel;\r\n","import { useState, useEffect, useContext } from \"react\";\r\nimport { UserContext } from \"../Home/UserContext\";\r\nimport { useLocation, useParams, Link } from \"react-router-dom\";\r\nimport AdminPanel from \"./Admin/AdminPanel\";\r\n// import EditCommunity from \"./Admin/EditCommunity\";\r\n\r\nexport interface CommunityBannerObj {\r\n  _id: string;\r\n  communityName: string;\r\n  description: string;\r\n  date: string;\r\n  admins: string[];\r\n  creatorUsername: string;\r\n}\r\n\r\nconst SERVER = process.env.REACT_APP_API_SERVER;\r\n\r\nexport const defaultCommunity: CommunityBannerObj = {\r\n  _id: \"\",\r\n  admins: [],\r\n  description: \"\",\r\n  date: \"\",\r\n  communityName: \"\",\r\n  creatorUsername: \"\",\r\n};\r\nconst CommunityBanner = () => {\r\n  const [communityName, setCommunityName] = useState(\"\");\r\n  const { username }: { username: string } = useContext(UserContext);\r\n  const [community, setCommunity] = useState<CommunityBannerObj>(\r\n    defaultCommunity\r\n  );\r\n  // changes when community is edited by admin\r\n  const [reload, setReload] = useState(false);\r\n\r\n  const params: { communityName: string; id: string } = useParams();\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    (async () => {\r\n      const resp = await fetch(SERVER + \"getCommunity/\" + params.communityName);\r\n      const jsoned: CommunityBannerObj = await resp.json();\r\n      if (!mounted) return;\r\n      if (\"error\" in jsoned) {\r\n        setCommunity(defaultCommunity);\r\n        setCommunityName(\"Error.\");\r\n        return;\r\n      }\r\n\r\n      setCommunity(jsoned);\r\n    })();\r\n    if (mounted) {\r\n      setCommunityName(params.communityName);\r\n    }\r\n\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n  }, [params.communityName, reload]);\r\n\r\n  // renders the admin panel\r\n  function renderAdminPanel() {\r\n    if (community.admins.includes(username))\r\n      return <AdminPanel community={community} setReload={setReload} />;\r\n  }\r\n\r\n  // returns the date to human readable format\r\n  function msToDate() {\r\n    const dateMS = parseInt(community.date);\r\n    const date = new Date(dateMS).toLocaleDateString(\"en-AU\").toString();\r\n\r\n    return date;\r\n  }\r\n\r\n  return (\r\n    <div className=\"container-fluid bg-info mb-3 d-flex\">\r\n      <div className=\"container py-3\">\r\n        <div className=\"row\">\r\n          <div className=\"col-lg-10 d-flex justify-content-between\">\r\n            <Link to={`/c/${communityName}`}>\r\n              <h3>{communityName}</h3>\r\n              <h6>{community.description}</h6>\r\n            </Link>\r\n\r\n            <h6>created {msToDate()}</h6>\r\n          </div>\r\n          <div className=\"col-lg-2\">{renderAdminPanel()}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CommunityBanner;\r\n","import { useState, useEffect, useContext } from \"react\";\r\nimport { IconContext } from \"react-icons\";\r\nimport { ImCross } from \"react-icons/im\";\r\nimport { Link, useParams, useHistory } from \"react-router-dom\";\r\nimport Post from \"./Post/Post\";\r\nimport AddPost from \"./AddPost\";\r\nimport { UserContext } from \"../Home/UserContext\";\r\nimport { defaultCommunity } from \"../Community/CommunityBanner\";\r\nimport io from \"socket.io-client\";\r\nimport { PostContext } from \"../Home/PostContext\";\r\nimport { CommunityBannerObj } from \"../Community/CommunityBanner\";\r\nimport { CommunityContext } from \"./CommunityContext\";\r\n\r\nconst SOCKET_SERVER: any = process.env.REACT_APP_SOCKET_SERVER;\r\nconst socket = io(SOCKET_SERVER);\r\nexport interface PostObj {\r\n  username: string;\r\n  content: string;\r\n  date: string; // TODO change\r\n\r\n  // post id\r\n  id: string;\r\n\r\n  // array of all the ids for children posts\r\n  childrenIDs: string[];\r\n\r\n  // the id of the parent post\r\n  parentID: string;\r\n\r\n  imageURL: string;\r\n\r\n  // if the post has been deleted\r\n  deleted?: boolean;\r\n}\r\n\r\nexport interface ThreadObject {\r\n  title: string;\r\n  username: string;\r\n  content: string;\r\n  _id: string;\r\n  posts: PostObj[];\r\n  error?: string;\r\n  id?: string;\r\n  date: string;\r\n}\r\nexport const defaultThread: ThreadObject = {\r\n  title: \"\",\r\n  content: \"\",\r\n  username: \"\",\r\n  _id: \"\",\r\n  posts: [],\r\n  date: \"1\",\r\n};\r\n\r\n// TODO if your own post / thread, you can delete\r\nconst Thread = () => {\r\n  const { username, setUsername } = useContext(UserContext);\r\n  const [thread, setThread] = useState<ThreadObject>(defaultThread);\r\n  const [community, setCommunity] = useState<CommunityBannerObj>(\r\n    defaultCommunity\r\n  );\r\n\r\n  const server = process.env.REACT_APP_API_SERVER;\r\n  const { communityName, id } = useParams<{\r\n    communityName: string;\r\n    id: string;\r\n  }>();\r\n  const hist = useHistory();\r\n  const [topLevelPosts, setTopLevelPosts] = useState<PostObj[]>([]);\r\n  const [newPostObj, setNewPostObj] = useState<PostObj | null>(null);\r\n  const [postToReload, setPostToReload] = useContext(PostContext).voteReload;\r\n  const [deletedPost, setDeletedPost] = useContext(PostContext).deleteReload;\r\n\r\n  /** Loads the thread. */\r\n  async function loadThread() {\r\n    const res = await fetch(`${server}getThread/${id}`);\r\n    const jsoned: ThreadObject = await res.json();\r\n\r\n    // thread doesn't exist or error in retrieving it\r\n    if (jsoned.hasOwnProperty(\"error\")) {\r\n      // redirect to home\r\n      hist.push(\"/home\");\r\n      return;\r\n    }\r\n\r\n    if (JSON.stringify(jsoned) !== JSON.stringify(thread)) {\r\n      setThread(jsoned);\r\n      // // get top level posts\r\n      setTopLevelPosts([]);\r\n      for (const post of jsoned.posts) {\r\n        if (post.parentID === null) {\r\n          setTopLevelPosts((current) => [...current, post]);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /** Deletes the thread. */\r\n  async function deleteThread() {\r\n    // TODO are u sure\r\n    const res = await fetch(`${server}deleteThread/${communityName}/${id}`);\r\n    // console.log(res.json());\r\n\r\n    // redirect to home\r\n    hist.push(`/c/${communityName}`);\r\n  }\r\n\r\n  /** Renders possible actions for owner of a thread. */\r\n  function renderOwnerActions() {\r\n    if (thread.username === username || community.admins.includes(username)) {\r\n      return (\r\n        <IconContext.Provider value={{ size: \"1em\" }}>\r\n          <ImCross\r\n            onClick={deleteThread}\r\n            style={{ cursor: \"pointer\", minWidth: \"15px\" }}\r\n            className=\"ml-2\"\r\n          />\r\n        </IconContext.Provider>\r\n      );\r\n    }\r\n  }\r\n\r\n  /** Gets a post by it's id */\r\n  function getPostByID(postID: string): PostObj | null {\r\n    // console.log(postID);\r\n    for (const post of thread.posts) {\r\n      if (post.id === postID) {\r\n        // console.log(post);\r\n        return post;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  // set community\r\n  useEffect(() => {\r\n    let mounted = true;\r\n\r\n    (async () => {\r\n      const resp = await fetch(server + \"getCommunity/\" + communityName);\r\n      const jsoned: CommunityBannerObj = await resp.json();\r\n      if (!mounted) return;\r\n      if (\"error\" in jsoned) {\r\n        setCommunity(defaultCommunity);\r\n        return;\r\n      }\r\n\r\n      setCommunity(jsoned);\r\n    })();\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n  }, [communityName]);\r\n\r\n  // load all the posts for given thread\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    loadThread();\r\n    if (mounted) {\r\n      // temp socket io\r\n      socket.connect();\r\n      socket.emit(\"onThread\", id);\r\n      socket.on(\"newPost\", (newPost: PostObj) => {\r\n        // store new post somewhere\r\n\r\n        // is top level\r\n        if (newPost.parentID === null) {\r\n          console.log(\"new top level post\");\r\n          setTopLevelPosts((current) => [...current, newPost]);\r\n          // TODO https://dev.to/otamnitram/react-useeffect-cleanup-how-and-when-to-use-it-2hbm\r\n        } else {\r\n          setNewPostObj(newPost);\r\n        }\r\n      });\r\n      // post had its votes changed, reload\r\n      socket.on(\"upvotePost\", (postID) => {\r\n        setPostToReload(postID);\r\n      });\r\n      // post deletion\r\n      socket.on(\"postDeleted\", (postID) => {\r\n        setDeletedPost(postID);\r\n      });\r\n    }\r\n\r\n    // cleanup\r\n    return () => {\r\n      mounted = false;\r\n      socket.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  // TODO if posts are empty, say no posts\r\n  return (\r\n    <CommunityContext.Provider value={community}>\r\n      <div className=\"container mt-3 mb-5\">\r\n        <div className=\"container\">\r\n          <div className=\"row\">\r\n            <div className=\"col d-inline-flex align-items-center\">\r\n              <h1 className=\"mb-0\">{thread.title}</h1>\r\n              {renderOwnerActions()}\r\n            </div>\r\n          </div>\r\n          <h6>- {thread.username}</h6>\r\n          <p style={{ wordWrap: \"break-word\" }}>{thread.content}</p>\r\n          <AddPost threadID={id} loadThread={loadThread} />\r\n        </div>\r\n        <h4 className=\"mt-5\">Replies:</h4>\r\n        <div className=\"container \">\r\n          {topLevelPosts.map((post, index) => (\r\n            <Post\r\n              key={index}\r\n              postID={post.id}\r\n              threadID={id}\r\n              loadThread={loadThread}\r\n              getPost={getPostByID}\r\n              indentLevel={0}\r\n              newPost={newPostObj}\r\n            />\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </CommunityContext.Provider>\r\n  );\r\n};\r\n\r\nexport default Thread;\r\n","import { useState } from \"react\";\r\nimport { useHistory, Link } from \"react-router-dom\";\r\nconst Register = () => {\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\r\n  const [status, setStatus] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const server = process.env.REACT_APP_API_SERVER;\r\n  const history = useHistory();\r\n  /** Checks if the passwords are the same. */\r\n  function checkPasswordsSame() {\r\n    if (password === confirmPassword) {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  /** Registers the user. */\r\n  async function registerUser(\r\n    e: React.MouseEvent<HTMLButtonElement, MouseEvent>\r\n  ) {\r\n    e.preventDefault();\r\n    setError(\"\");\r\n    setStatus(\"\");\r\n\r\n    if (!checkPasswordsSame()) {\r\n      return;\r\n    }\r\n\r\n    const obj = {\r\n      username: username,\r\n      password: password,\r\n    };\r\n\r\n    // send off to server\r\n    const url = server + \"register\";\r\n    try {\r\n      const result = await fetch(url, {\r\n        body: JSON.stringify(obj),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        method: \"POST\",\r\n      });\r\n      const response = await result.json();\r\n\r\n      if (response.hasOwnProperty(\"error\")) {\r\n        setError(response.error);\r\n        // setStatus(response.error)\r\n        return;\r\n      }\r\n\r\n      setStatus(response.status);\r\n\r\n      // delay before redirect\r\n      await new Promise((r) => setTimeout(r, 1500));\r\n\r\n      // redirect to home\r\n      history.push(\"/login\");\r\n\r\n      // TODO if it fails??\r\n      // console.log(response);\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  }\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"row\">\r\n        <div className=\"col-12 col-sm-8 offset-sm-2 col-xl-6 offset-xl-3\">\r\n          <form className=\"mt-5\">\r\n            <h1 className=\"mb-4 text-center\">Register</h1>\r\n            <div className=\"form-group mb-2\">\r\n              <label>Username</label>\r\n              <input\r\n                type=\"text\"\r\n                value={username}\r\n                onChange={(e) => setUsername(e.target.value)}\r\n                className=\"form-control\"\r\n                placeholder=\"Enter username\"\r\n              />\r\n            </div>\r\n            <div className=\"form-group mb-2\">\r\n              <label>Password</label>\r\n              <input\r\n                type=\"password\"\r\n                value={password}\r\n                onChange={(e) => setPassword(e.target.value)}\r\n                className=\"form-control\"\r\n                placeholder=\"Enter password\"\r\n              />\r\n            </div>\r\n            <div className=\"form-group mb-3\">\r\n              <label>Confirm Password</label>\r\n              <input\r\n                type=\"password\"\r\n                value={confirmPassword}\r\n                onChange={(e) => setConfirmPassword(e.target.value)}\r\n                className=\"form-control\"\r\n                placeholder=\"Enter password\"\r\n              />\r\n            </div>\r\n            <button\r\n              type=\"submit\"\r\n              onClick={(e) => registerUser(e)}\r\n              className=\"btn btn-primary\"\r\n            >\r\n              Submit\r\n            </button>\r\n          </form>\r\n          <Link to=\"/login\">\r\n            <div className=\"mt-1\">Already registered? Click here to login!</div>\r\n          </Link>\r\n          {status.length > 0 && (\r\n            <h5 className=\"mt-3 alert alert-success\">{status}</h5>\r\n          )}\r\n          {error.length > 0 && (\r\n            <h5 className=\"mt-3 alert alert-danger\">{error}</h5>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Register;\r\n","import { useState, useContext } from \"react\";\r\nimport { UserContext } from \"../Home/UserContext\";\r\n\r\ninterface Props {\r\n  communityName: string;\r\n}\r\n\r\ninterface NewThread {\r\n  username: string;\r\n  content: string;\r\n  title: string;\r\n  communityName: string;\r\n}\r\n\r\nconst MAX_THREAD_TITLE_LENGTH = 150;\r\nconst MAX_THREAD_CONTENT_LENGTH = 5000;\r\n\r\nconst AddThread = ({ communityName }: Props) => {\r\n  const [addThreadOn, setAddThreadOn] = useState<boolean>(false);\r\n  const server = process.env.REACT_APP_API_SERVER;\r\n  const [content, setContent] = useState<string>(\"\");\r\n  const [title, setTitle] = useState<string>(\"\");\r\n  const { username } = useContext(UserContext);\r\n\r\n  // the error message if needed\r\n  const [status, setStatus] = useState<string>(\"\");\r\n\r\n  /** Checks if the thread is valid. */\r\n  function checkThreadValidity() {\r\n    if (content.length > MAX_THREAD_CONTENT_LENGTH) {\r\n      setStatus(\"Exceeded content length!\");\r\n      return false;\r\n    }\r\n\r\n    if (title.length > MAX_THREAD_TITLE_LENGTH) {\r\n      setStatus(\"Exceeded title length!\");\r\n      return false;\r\n    }\r\n\r\n    setStatus(\"\");\r\n    return true;\r\n  }\r\n\r\n  /** Makes a post to the server */\r\n  async function makeThread() {\r\n    // error checking\r\n    if (!checkThreadValidity()) return;\r\n\r\n    const thread: NewThread = {\r\n      username: username,\r\n      content: content,\r\n      title: title,\r\n      communityName: communityName,\r\n    };\r\n\r\n    try {\r\n      const result = await fetch(server + \"newThread\", {\r\n        body: JSON.stringify(thread),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        method: \"POST\",\r\n      });\r\n      setAddThreadOn((current) => !current);\r\n    } catch (error) {\r\n      // TODO error handling\r\n    }\r\n  }\r\n\r\n  /** The error message to be displayed. */\r\n  function errorMessage() {\r\n    if (status.length === 0) return;\r\n\r\n    return <h5 className=\"alert alert-danger mt-2\">{status}</h5>;\r\n  }\r\n\r\n  /** Renders the input form if needed */\r\n  function inputForm() {\r\n    if (addThreadOn) {\r\n      return (\r\n        <div className=\"form-group mt-4\">\r\n          <label className=\"\">Title</label>\r\n          <input\r\n            type=\"text\"\r\n            className=\"form-control\"\r\n            onChange={(e) => setTitle(e.target.value)}\r\n          />\r\n          <label className=\"\">Content</label>\r\n          <textarea\r\n            onChange={(e) => setContent(e.target.value)}\r\n            className=\"form-control border border-secondary\"\r\n          />\r\n          <button onClick={makeThread} className=\"btn btn-primary mt-2\">\r\n            Submit\r\n          </button>\r\n          {errorMessage()}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <button\r\n        className=\"btn btn-primary\"\r\n        onClick={() => setAddThreadOn((current) => !current)}\r\n      >\r\n        Add Thread\r\n      </button>\r\n    );\r\n  }\r\n\r\n  return <div className=\"mb-5\">{inputForm()}</div>;\r\n};\r\n\r\nexport default AddThread;\r\n","import { useHistory, Link } from \"react-router-dom\";\r\nimport { ThreadObject, defaultThread } from \"../Thread/Thread\";\r\nimport { useState, useEffect } from \"react\";\r\nimport prettyMS from \"pretty-ms\";\r\ninterface Props {\r\n  threadID: string;\r\n  communityName: string;\r\n}\r\n\r\nconst CONTENT_MAX_LEN = 500;\r\n\r\nconst ThreadCard = ({ threadID, communityName }: Props) => {\r\n  const history = useHistory();\r\n  // const [content, setContent] = useState<string>(\"\");\r\n  // const [title, setTitle] = useState<string>(\"\");\r\n  const [thread, setThread] = useState<ThreadObject>(defaultThread);\r\n  const server = process.env.REACT_APP_API_SERVER;\r\n  const [timeSince, setTimeSince] = useState<number>(0);\r\n\r\n  useEffect(() => {\r\n    let timer = setInterval(() => {\r\n      const time = new Date().getTime() - parseInt(thread.date);\r\n\r\n      setTimeSince(time);\r\n    }, 100);\r\n\r\n    // cleanup\r\n    return () => {\r\n      clearTimeout(timer);\r\n    };\r\n  }, [thread.date]);\r\n\r\n  /** Truncates text if necessary */\r\n  function truncatedText() {\r\n    if (thread.content.length > CONTENT_MAX_LEN) {\r\n      return thread.content.substring(1, 500) + \"...\";\r\n    }\r\n\r\n    return thread.content;\r\n  }\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    (async () => {\r\n      const resp = await fetch(server + \"/getThread/\" + threadID);\r\n      const jsoned = await resp.json();\r\n      // console.log(jsoned);\r\n      if (mounted) {\r\n        setThread(jsoned);\r\n      }\r\n    })();\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n  }, []);\r\n\r\n  function getTime() {\r\n    if (!thread.date) {\r\n      return;\r\n    }\r\n\r\n    return prettyMS(timeSince, { compact: true, verbose: true }) + \" ago\";\r\n  }\r\n\r\n  // TODO limit post length, client side and server side\r\n  return (\r\n    <Link to={`/c/${communityName}/${threadID}`}>\r\n      <div className=\"border border-primary rounded my-2 p-2\">\r\n        <div className=\"ml-2\">\r\n          <small className=\"\">\r\n            Posted by: {thread.username} {getTime()}\r\n          </small>\r\n          <h4>{thread.title}</h4>\r\n          <p style={{ wordWrap: \"break-word\" }}>{truncatedText()}</p>\r\n        </div>\r\n      </div>\r\n    </Link>\r\n  );\r\n};\r\n\r\nexport default ThreadCard;\r\n","import { useState, useEffect, useRef } from \"react\";\r\nimport AddThread from \"./AddThread\";\r\nimport ThreadCard from \"./ThreadCard\";\r\nimport { ThreadObject } from \"../Thread/Thread\";\r\nimport { useParams } from \"react-router-dom\";\r\n\r\nimport io from \"socket.io-client\";\r\nconst SOCKET_SERVER: any = process.env.REACT_APP_SOCKET_SERVER;\r\nconst socket = io(SOCKET_SERVER);\r\n\r\nconst Home = () => {\r\n  const [threads, setThreads] = useState<string[]>([]);\r\n  const server = process.env.REACT_APP_API_SERVER;\r\n  const { communityName } = useParams<{ communityName: string }>();\r\n  const [error, setError] = useState(\"\");\r\n\r\n  // stateRef.current = threads;\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    (async () => {\r\n      const threads = await fetch(server + \"getThreads/\" + communityName);\r\n      const jsoned = await threads.json();\r\n      if (\"error\" in jsoned) {\r\n        setError(\"Sorry! this page doesn't exist.\");\r\n        return;\r\n      }\r\n      if (!mounted) {\r\n        return;\r\n      }\r\n      if (mounted) {\r\n        setError(\"\");\r\n        setThreads(jsoned.threads);\r\n      }\r\n    })();\r\n\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n  }, [communityName]);\r\n\r\n  // load all the posts for given thread\r\n  useEffect(() => {\r\n    // temp socket io\r\n    socket.connect();\r\n    socket.emit(\"onCommunity\", communityName);\r\n    socket.on(\"newThread\", (newThread: ThreadObject) => {\r\n      setThreads((current) => {\r\n        if (!current.includes(newThread._id)) {\r\n          return [...current, newThread._id];\r\n        }\r\n        return current;\r\n      });\r\n    });\r\n\r\n    socket.on(\"deletedThread\", (threadID: string) => {\r\n      setThreads((current) => current.filter((x) => x !== threadID));\r\n    });\r\n\r\n    // cleanup\r\n    return () => {\r\n      socket.disconnect();\r\n    };\r\n  }, [communityName, threads]);\r\n\r\n  // error message\r\n  function renderError() {\r\n    if (error !== \"\") {\r\n      return <h1 className=\"alert alert-danger\">{error}</h1>;\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      {error === \"\" &&\r\n        threads.map((thread) => (\r\n          <ThreadCard\r\n            key={thread}\r\n            threadID={thread}\r\n            communityName={communityName}\r\n          />\r\n        ))}\r\n      {renderError()}\r\n      {error === \"\" && <AddThread communityName={communityName} />}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n","import { useState, useContext } from \"react\";\r\nimport { UserContext } from \"./UserContext\";\r\nimport OverlayComponent from \"../GenericComponents/OverlayComponent\";\r\n\r\nexport interface NewCommunity {\r\n  /** The user who created the community. */\r\n  creatorUsername: string;\r\n\r\n  /** The community's description. */\r\n  description: string;\r\n\r\n  /** The date the community was created. */\r\n  date: string;\r\n\r\n  /** The community's name. */\r\n  communityName: string;\r\n\r\n  /** Admin users who can moderate the community. */\r\n  admins: string[];\r\n}\r\n\r\nexport interface Community extends NewCommunity {\r\n  _id: string;\r\n}\r\n\r\nconst MAX_THREAD_TITLE_LENGTH = 150;\r\nconst MAX_THREAD_CONTENT_LENGTH = 5000;\r\n\r\ninterface Props {\r\n  addCommunity: (community: Community) => void;\r\n}\r\n\r\nconst AddCommunity = ({ addCommunity }: Props) => {\r\n  const server = process.env.REACT_APP_API_SERVER;\r\n\r\n  const [addCommunityOn, setAddCommunityOn] = useState<boolean>(false);\r\n  const [description, setDescription] = useState<string>(\"\");\r\n  const [communityName, setCommunityName] = useState<string>(\"\");\r\n  const { username } = useContext(UserContext);\r\n\r\n  // the error message if needed\r\n  const [status, setStatus] = useState<string>(\"\");\r\n\r\n  // /** Checks if the thread is valid. */\r\n  // function checkThreadValidity() {\r\n  //   if (content.length > MAX_THREAD_CONTENT_LENGTH) {\r\n  //     setStatus(\"Exceeded content length!\");\r\n  //     return false;\r\n  //   }\r\n\r\n  //   if (title.length > MAX_THREAD_TITLE_LENGTH) {\r\n  //     setStatus(\"Exceeded title length!\");\r\n  //     return false;\r\n  //   }\r\n\r\n  //   setStatus(\"\");\r\n  //   return true;\r\n  // }\r\n\r\n  /** Makes a post to the server */\r\n  async function makeCommunity() {\r\n    // error checking\r\n    // if (!checkThreadValidity()) return;\r\n    const newCommunity: NewCommunity = {\r\n      admins: [],\r\n      communityName: communityName,\r\n      creatorUsername: username,\r\n      date: new Date().getTime().toString(),\r\n      description: description,\r\n    };\r\n    try {\r\n      const result = await fetch(server + \"addCommunity\", {\r\n        body: JSON.stringify(newCommunity),\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        method: \"POST\",\r\n      });\r\n      const jsoned = await result.json();\r\n      if (!(\"_id\" in jsoned)) {\r\n        // it failed\r\n        setStatus(\r\n          \"Sorry the community name as already been taken. Please try again!\"\r\n        );\r\n        console.log(\"failed\");\r\n        setAddCommunityOn((current) => !current);\r\n        return;\r\n      }\r\n      setStatus(\"\");\r\n      addCommunity(jsoned);\r\n      setAddCommunityOn((current) => !current);\r\n    } catch (error) {\r\n      // TODO error handling\r\n    }\r\n  }\r\n\r\n  /** The error message to be displayed. */\r\n  function errorMessage() {\r\n    if (status.length === 0) return;\r\n\r\n    return <h5 className=\"alert alert-danger mt-2\">{status}</h5>;\r\n  }\r\n\r\n  /** Renders the input form if needed */\r\n  function inputForm() {\r\n    if (addCommunityOn) {\r\n      return (\r\n        <OverlayComponent>\r\n          <h3>Create a community</h3>\r\n          <label className=\"text-left mt-2\">Community Name</label>\r\n          <input\r\n            type=\"text\"\r\n            className=\"form-control\"\r\n            onChange={(e) => setCommunityName(e.target.value)}\r\n          />\r\n          <label className=\"mt-4 text-left\">Description</label>\r\n          <textarea\r\n            className=\"form-control\"\r\n            onChange={(e) => setDescription(e.target.value)}\r\n            rows={8}\r\n          />\r\n          <div className=\"d-flex justify-content-end mt-3\">\r\n            <button\r\n              onClick={() => setAddCommunityOn((current) => !current)}\r\n              className=\"btn btn-primary mt-2 mr-2\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              onClick={makeCommunity}\r\n              className=\"btn btn-outline-primary mt-2\"\r\n            >\r\n              Submit\r\n            </button>\r\n          </div>\r\n        </OverlayComponent>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div>\r\n        <button\r\n          className=\"btn btn-primary\"\r\n          onClick={() => setAddCommunityOn((current) => !current)}\r\n        >\r\n          Add New Community\r\n        </button>\r\n        {errorMessage()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return <div className=\"mb-5\">{inputForm()}</div>;\r\n};\r\n\r\nexport default AddCommunity;\r\n","import { useEffect, useState } from \"react\";\r\nimport Fuzzy from \"fuzzy\";\r\nimport { Link } from \"react-router-dom\";\r\nimport AddCommunity, { Community } from \"./AddCommunity\";\r\n\r\ninterface CommunityStub {\r\n  _id: string;\r\n  communityName: string;\r\n  description: string;\r\n}\r\n\r\nconst Mainpage = () => {\r\n  const [communitites, setCommunities] = useState<CommunityStub[]>([]);\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const [renderedCommunities, setRenderedCommunities] = useState<string[]>([]);\r\n  const server = process.env.REACT_APP_API_SERVER;\r\n\r\n  function addCommunity(community: Community) {\r\n    const smallCommunityStub: CommunityStub = {\r\n      _id: community._id,\r\n      communityName: community.communityName,\r\n      description: community.description,\r\n    };\r\n    setError(\"\");\r\n    setSearchValue(\"\");\r\n    setCommunities((currentCommunites) => [\r\n      ...currentCommunites,\r\n      smallCommunityStub,\r\n    ]);\r\n    setRenderedCommunities([\r\n      ...communitites.map((c) => c.communityName),\r\n      smallCommunityStub.communityName,\r\n    ]);\r\n    // console.log(community);\r\n  }\r\n\r\n  useEffect(() => {\r\n    // fetch communities\r\n    (async () => {\r\n      const resp = await fetch(`${server}/getCommunities`);\r\n      const jsoned = await resp.json();\r\n\r\n      setCommunities(jsoned);\r\n      setRenderedCommunities(\r\n        jsoned.map((community: CommunityStub) => community.communityName)\r\n      );\r\n    })();\r\n    searchCommunities(\"\");\r\n  }, []);\r\n\r\n  /** Searches the communities for the given search term. */\r\n  function searchCommunities(searchText: string) {\r\n    setSearchValue(searchText);\r\n    if (searchText === \"\") {\r\n      setRenderedCommunities(\r\n        communitites.map((community) => community.communityName)\r\n      );\r\n      setError(\"\");\r\n      return;\r\n    }\r\n    const results = Fuzzy.filter(searchText, communitites, {\r\n      extract: (item) => item.communityName,\r\n    });\r\n    setRenderedCommunities(results.map((item) => item.string));\r\n\r\n    // no matches\r\n    if (results.length === 0) {\r\n      setError(\"No matching communities could be found!\");\r\n    } else {\r\n      setError(\"\");\r\n    }\r\n  }\r\n\r\n  /** Renders the error message */\r\n  function renderError() {\r\n    if (error !== \"\") {\r\n      return <h3 className=\"alert alert-danger\">{error}</h3>;\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mt-5 text-center\">\r\n      <h1>this is main page</h1>\r\n      <p>Search for a community or click on one to visit it</p>\r\n      <div>\r\n        <input\r\n          type=\"text\"\r\n          className=\"w-75\"\r\n          onChange={(e) => searchCommunities(e.target.value)}\r\n          value={searchValue}\r\n        ></input>\r\n      </div>\r\n      <div className=\"row d-flex mt-4 flex-row text-left mx-5\">\r\n        {renderedCommunities.map((community) => (\r\n          <Link key={community} to={\"/c/\" + community}>\r\n            <div className=\"mx-2 \">\r\n              <h4>{community}</h4>\r\n            </div>\r\n          </Link>\r\n        ))}\r\n      </div>\r\n      {renderError()}\r\n      <AddCommunity addCommunity={addCommunity} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Mainpage;\r\n","import Header from \"./Boiler/Header\";\nimport Footer from \"./Boiler/Footer\";\nimport Login from \"./UserAuth/Login\";\nimport Thread from \"./Thread/Thread\";\nimport Register from \"./UserAuth/Register\";\nimport Home from \"./Community/Home\";\nimport { useState } from \"react\";\nimport { HashRouter as Router, Switch, Route, Link } from \"react-router-dom\";\nimport \"./App.css\";\nimport { UserContext } from \"./Home/UserContext\";\nimport { PostContext } from \"./Home/PostContext\";\nimport Mainpage from \"./Home/MainPage\";\nimport CommunityBanner from \"./Community/CommunityBanner\";\n\nfunction App() {\n  const [username, setUsername] = useState(\"\");\n  const [postToReload, setPostToReload] = useState<string | null>(null);\n  const [deletedPost, setDeletedPost] = useState<string | null>(null);\n\n  return (\n    <Router basename=\"/\">\n      <UserContext.Provider value={{ username, setUsername }}>\n        <Header />\n        <Switch>\n          <Route path=\"/register\">\n            <Register />\n          </Route>\n          <Route path=\"/login\">\n            <Login />\n          </Route>\n          <Route path=\"/c/:communityName/:id\">\n            <PostContext.Provider\n              value={{\n                voteReload: [postToReload, setPostToReload],\n                deleteReload: [deletedPost, setDeletedPost],\n              }}\n            >\n              <CommunityBanner />\n              <Thread />\n            </PostContext.Provider>\n          </Route>\n          <Route path=\"/c/:communityName\">\n            <CommunityBanner />\n            <Home />\n          </Route>\n          <Route path=\"/home\">\n            <Mainpage />\n          </Route>\n          <Route path=\"/\">\n            <Login />\n          </Route>\n        </Switch>\n        <Footer />\n      </UserContext.Provider>\n    </Router>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n\n"],"sourceRoot":""}