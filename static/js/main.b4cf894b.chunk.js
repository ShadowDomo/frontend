(this.webpackJsonpfakeshop=this.webpackJsonpfakeshop||[]).push([[0],{101:function(e,t,n){},102:function(e,t,n){},103:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n.n(r),a=n(55),s=n.n(a),i=n(3),o=n(7),u=n(4),l=n.n(u),j=n(5),d=n(6),b=Object(r.createContext)(null),m=n(1),h=function(){var e="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",t=Object(r.useContext)(b),n=t.username,c=t.setUsername,a=Object(d.f)(),s=Object(d.g)();function i(){return(i=Object(j.a)(l.a.mark((function t(){var n,r,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(n=localStorage.getItem("sessionID"))){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,fetch(e+"getUsername/"+n);case 6:return r=t.sent,t.next=9,r.json();case 9:if((i=t.sent).username||["/login","/register"].includes(s.pathname)){t.next=13;break}return a.push("/login"),t.abrupt("return");case 13:c(i.username),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(3),a.push("/login");case 19:case"end":return t.stop()}}),t,null,[[3,16]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){var e=!0;return"/"===s.pathname||"/login"===s.pathname?(localStorage.removeItem("sessionID"),a.push("/login"),void(e&&c(""))):(function(){i.apply(this,arguments)}(),function(){e=!1})}),[s.pathname]),Object(m.jsxs)("div",{children:[Object(m.jsx)("h6",{className:"text-white",children:n}),Object(m.jsxs)("div",{className:"d-flex flex-row",children:[Object(m.jsx)(o.b,{className:"mr-3",to:"/login",onClick:function(){localStorage.removeItem("sessionID"),c("")},children:n&&n.length>0?Object(m.jsx)("h5",{className:"text-primary",children:"logout"}):"/register"===s.pathname?Object(m.jsx)("h5",{children:"Login"}):void 0}),Object(m.jsx)(o.b,{to:"/register",children:function(){if("/register"!==s.pathname)return n?void 0:Object(m.jsx)("h5",{className:"font-weight-bold",children:"Register"})}()})]})]})},p=function(){return Object(m.jsxs)("div",{className:"bg-dark navbar w-100 static-top",children:[Object(m.jsx)(o.b,{to:function(){return null===localStorage.getItem("sessionID")?"#":"/home"},children:Object(m.jsx)("h1",{className:"navbar-brand mx-3 text-light",children:"Forum Clone"})}),Object(m.jsx)(h,{})]})},f=function(){return Object(m.jsx)("div",{children:Object(m.jsx)(p,{})})},O=function(){return Object(m.jsx)("div",{className:"bg-dark w-100",style:{position:"fixed",bottom:0},children:Object(m.jsx)("h6",{className:"text-light m-2",children:"Dom Zhu - 2021"})})},x=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),s=Object(i.a)(a,2),u=s[0],h=s[1],p=Object(r.useState)(""),f=Object(i.a)(p,2),O=f[0],x=f[1],y=Object(d.f)(),v=(Object(r.useContext)(b).username,Object(r.useContext)(b).setUsername),g=Object(d.g)(),N="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/";function w(){return(w=Object(j.a)(l.a.mark((function e(t){var r,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r={username:n,password:u},N+"login",e.prev=3,e.next=6,fetch("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/login",{body:JSON.stringify(r),headers:{"Content-Type":"application/json"},method:"POST"});case 6:return c=e.sent,e.next=9,c.json();case 9:if(!(a=e.sent).hasOwnProperty("error")){e.next=13;break}return x(a.error),e.abrupt("return");case 13:localStorage.setItem("sessionID",a.sessionID),v(n),y.push("/home"),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),x("Failed to login. Please try again.");case 21:case"end":return e.stop()}}),e,null,[[3,18]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){v(""),"/login"!==g.pathname&&y.push("/login")}),[g.pathname,y,v]),Object(m.jsx)("div",{className:"container",children:Object(m.jsx)("div",{className:"row",children:Object(m.jsxs)("div",{className:"col-12 col-sm-8 offset-sm-2 col-xl-6 offset-xl-3",children:[Object(m.jsxs)("form",{className:"mt-5",children:[Object(m.jsx)("h1",{className:"mb-4 text-center",children:"Login"}),Object(m.jsxs)("div",{className:"form-group mb-2",children:[Object(m.jsx)("label",{children:"Username"}),Object(m.jsx)("input",{type:"text",value:n,onChange:function(e){return c(e.target.value)},className:"form-control",placeholder:"Enter username"})]}),Object(m.jsxs)("div",{className:"form-group mb-3",children:[Object(m.jsx)("label",{children:"Password"}),Object(m.jsx)("input",{type:"password",value:u,onChange:function(e){return h(e.target.value)},className:"form-control",placeholder:"Enter password"})]}),Object(m.jsx)("button",{type:"submit",onClick:function(e){return w.apply(this,arguments)},className:"btn btn-primary",children:"Submit"})]}),Object(m.jsx)(o.b,{to:"/register",children:Object(m.jsx)("div",{className:"mt-1",children:"New user? Click here to register!"})}),O.length>0&&Object(m.jsx)("h5",{className:"mt-3 alert alert-danger",children:O})]})})})},y=n(9),v=n(37),g=n(0),N=n(57),w=function(e){var t=e.threadID,n=(e.loadThread,e.noRenderButton),c=e.parentPostID,a=e.setRenderReplyForm,s=Object(r.useState)(!1),o=Object(i.a)(s,2),u=o[0],d=o[1],h="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",p=Object(r.useState)(""),f=Object(i.a)(p,2),O=f[0],x=f[1],y=Object(r.useContext)(b).username,v=Object(r.useState)(""),g=Object(i.a)(v,2),N=g[0],w=g[1];function k(){return S.apply(this,arguments)}function S(){return(S=Object(j.a)(l.a.mark((function e(){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={username:y,content:O,date:(new Date).getTime().toString(),threadID:t,childrenIDs:[],parentID:c,imageURL:N},e.prev=1,e.next=4,fetch(h+"makePost",{body:JSON.stringify(n),headers:{"Content-Type":"application/json"},method:"POST"});case 4:return r=e.sent,e.next=7,r.json();case 7:e.sent,d((function(e){return!e})),x(""),w(""),e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(1),e.abrupt("return");case 16:C();case 17:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function C(){d(!1),a&&a(!1)}return Object(r.useEffect)((function(){d(void 0!==n)}),[]),Object(m.jsxs)(m.Fragment,{children:[u&&Object(m.jsxs)("div",{className:"form-group mt-4 mb-5",children:[Object(m.jsx)("label",{className:"",children:"Content"}),Object(m.jsx)("textarea",{value:O,placeholder:"What are your thoughts?",onChange:function(e){return x(e.target.value)},className:"form-control border border-secondary",rows:6}),Object(m.jsxs)("div",{className:"mt-3",children:[Object(m.jsx)("label",{children:"Image url"}),Object(m.jsx)("input",{value:N,type:"text",onChange:function(e){return w(e.target.value)},className:"form-control border border-secondary"})]}),Object(m.jsxs)("div",{className:"d-flex flex-row justify-content-end",children:[Object(m.jsx)("button",{onClick:function(e){return C()},className:"btn btn-primary mt-2",children:"Cancel"}),Object(m.jsx)("button",{onClick:k,className:"btn btn-primary mt-2 ml-3 bg-secondary text-dark border border-secondary",children:"Submit"})]})]}),!u&&!n&&Object(m.jsx)("div",{children:Object(m.jsx)("button",{className:"btn btn-primary",onClick:function(){return d((function(e){return!e}))},children:"Add Reply"})})]})},k=n(28),S=n.n(k),C=function(e){var t=e.post,n=Object(r.useState)(0),c=Object(i.a)(n,2),a=c[0],s=c[1];return Object(r.useEffect)((function(){var e=setInterval((function(){var e=(new Date).getTime()-parseInt(t.date);s(e)}),100);return function(){clearTimeout(e)}}),[t.date]),Object(m.jsxs)("div",{className:"row p-2 d-flex justify-content-between",children:[Object(m.jsx)("h6",{className:"text-white ml-1",children:t.username}),Object(m.jsx)("h6",{children:"1"!==t.date&&Object(m.jsxs)("small",{className:"ml-3 text-muted",children:[S()(a,{compact:!0})," ago"]})})]})},D=function(e){var t=e.post,n=e.renderChildren,c=e.setRenderReplyForm,a=e.setRenderChildren,s=e.deletePost,i=Object(r.useContext)(b).username,o="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/";function u(){return(u=Object(j.a)(l.a.mark((function e(){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(o+"hidePost",{body:JSON.stringify({username:i,postID:t.id,hidden:n}),headers:{"Content-Type":"application/json"},method:"POST"});case 2:return r=e.sent,e.next=5,r.json();case 5:e.sent;case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(){a((function(e){return!e})),function(){u.apply(this,arguments)}()}return Object(m.jsx)("div",{className:"row",children:Object(m.jsxs)("div",{className:"col d-flex",children:[Object(m.jsx)("div",{children:Object(m.jsx)("h6",{className:"text-muted",children:Object(m.jsx)("small",{style:{cursor:"pointer"},onClick:function(e){return c((function(e){return!e}))},children:"Reply"})})}),0===t.childrenIDs.length?null:Object(m.jsx)("div",{className:"ml-3",children:Object(m.jsx)("h6",{className:"text-muted",children:Object(m.jsxs)("small",{style:{cursor:"pointer"},onClick:function(e){return d()},children:[!n&&"Show Replies",n&&"Hide Replies"]})})}),function(){if(!t.deleted&&t.username===i)return Object(m.jsx)("div",{className:"ml-3",children:Object(m.jsx)("h6",{className:"text-muted",children:Object(m.jsx)("small",{style:{cursor:"pointer"},onClick:function(e){return s()},children:"Delete Post"})})})}()]})})},I=function(e){var t=e.post;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{className:"row pl-2",children:Object(m.jsx)("div",{className:"text-white ml-1",children:t.deleted?Object(m.jsx)("h6",{className:"text-danger",children:"[Deleted]"}):Object(m.jsx)("p",{style:{wordBreak:"break-word"},children:t.content})})}),function(){if(!t.deleted)return""!==t.imageURL?Object(m.jsx)("img",{className:"mb-2",style:{maxWidth:"400px",width:"100%",height:"auto"},src:t.imageURL,alt:""}):void 0}()]})},T=n(25),P=Object(r.createContext)(null),R=function(e){var t=e.postID,n=e.username,c=Object(r.useState)(0),a=Object(i.a)(c,2),s=a[0],o=a[1],u="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",d=Object(r.useState)(0),b=Object(i.a)(d,2),h=b[0],p=b[1],f=Object(r.useContext)(P).voteReload,O=Object(i.a)(f,2),x=O[0],y=O[1];function v(){return N.apply(this,arguments)}function N(){return(N=Object(j.a)(l.a.mark((function e(){var r,c,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,fetch(u+"getPostVotes",{body:JSON.stringify({postID:t}),headers:{"Content-Type":"application/json"},method:"POST"});case 4:return r=e.sent,e.next=7,r.json();case 7:return c=e.sent,o(parseInt(c.votes)),e.next=11,fetch(u+"getUsersVotes",{body:JSON.stringify({postID:t,username:n}),headers:{"Content-Type":"application/json"},method:"POST"});case 11:return a=e.sent,e.next=14,a.json();case 14:s=e.sent,p(s.vote);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return k.apply(this,arguments)}function k(){return(k=Object(j.a)(l.a.mark((function e(r){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c={postID:t,vote:r,username:n},fetch(u+"upvotePost",{body:JSON.stringify(c),headers:{"Content-Type":"application/json"},method:"POST"});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){var e=!0;return e&&x===t&&(v(),y(null)),function(){e=!1}}),[x]),Object(r.useEffect)((function(){v()}),[n]),Object(m.jsx)("div",{className:"d-flex flex-column mx-2",children:Object(m.jsxs)(g.b.Provider,{value:{size:"2em"},children:[1===h&&Object(m.jsx)(T.b,{style:{cursor:"pointer",color:"orange"},onClick:function(e){return w("1")}}),1!==h&&Object(m.jsx)(T.b,{style:{cursor:"pointer"},onClick:function(e){return w("1")}}),Object(m.jsx)("h5",{className:"text-white text-center",style:{marginBottom:"0"},children:s}),-1===h&&Object(m.jsx)(T.a,{style:{cursor:"pointer",color:"blue"},onClick:function(e){return w("-1")}}),-1!==h&&Object(m.jsx)(T.a,{style:{cursor:"pointer"},onClick:function(e){return w("-1")}})]})})},E="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",q=function e(t){var n=t.postID,c=t.threadID,a=t.loadThread,s=t.getPost,o=t.indentLevel,u=t.newPost,d=Object(r.useContext)(b).username,h=Object(r.useState)({childrenIDs:[],content:"loading...",date:"1",id:"",imageURL:"",parentID:"",username:"loading..."}),p=Object(i.a)(h,2),f=p[0],O=p[1],x=Object(r.useState)([]),v=Object(i.a)(x,2),g=v[0],N=v[1],k=Object(r.useState)(!1),S=Object(i.a)(k,2),T=S[0],q=S[1],J=Object(r.useState)(!0),U=Object(i.a)(J,2),L=U[0],F=U[1],A=Object(r.useState)(u),W=Object(i.a)(A,2),_=W[0],B=W[1],z=Object(i.a)(Object(r.useContext)(P).deleteReload,2),H=z[0],V=z[1],M=20*o;function Z(e){return G.apply(this,arguments)}function G(){return(G=Object(j.a)(l.a.mark((function e(t){var n,r,a,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={threadID:c,postID:t},e.next=3,fetch(E+"getPost",{body:JSON.stringify(n),headers:{"Content-Type":"application/json"},method:"POST"});case 3:return r=e.sent,e.next=6,r.json();case 6:return a=e.sent,e.next=9,fetch(E+"isPostHidden",{body:JSON.stringify({username:d,postID:t}),headers:{"Content-Type":"application/json"},method:"POST"});case 9:return s=e.sent,e.next=12,s.json();case 12:return i=e.sent,F(!i.status),e.abrupt("return",a);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){return(K=Object(j.a)(l.a.mark((function e(){var t,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={threadID:c,postID:n},e.prev=1,e.next=4,fetch(E+"deletePost",{body:JSON.stringify(t),headers:{"Content-Type":"application/json"},method:"POST"});case 4:return r=e.sent,e.next=7,r.json();case 7:if(!e.sent.hasOwnProperty("status")){e.next=13;break}return e.next=11,Z(n);case 11:a=e.sent,O(a);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){var e=!0;return function(){var t=Object(j.a)(l.a.mark((function t(){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Z(n);case 2:r=t.sent,e&&(O(r),N(r.childrenIDs));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()(),function(){e=!1}}),[]),Object(r.useEffect)((function(){if(H===n){var e=f;e.deleted=!0,O(e),V(null)}}),[H]),Object(r.useEffect)((function(){if(null!==u){if(u.parentID===n){N((function(e){return[].concat(Object(y.a)(e),[u.id])}));var e=f;return e.childrenIDs=[].concat(Object(y.a)(f.childrenIDs),[u.id]),O(e),void B(null)}B(u)}}),[u]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{style:{marginLeft:M,width:"auto"},children:[Object(m.jsxs)("div",{className:"my-3 d-flex border border-secondary rounded bg-dark",children:[Object(m.jsx)(R,{postID:n,username:d}),Object(m.jsxs)("div",{className:"container",style:{paddingLeft:"0"},children:[Object(m.jsx)(C,{post:f}),Object(m.jsx)(I,{post:f}),Object(m.jsx)(D,{post:f,renderChildren:L,setRenderReplyForm:q,setRenderChildren:F,deletePost:function(){return K.apply(this,arguments)}})]})]}),function(){if(T)return Object(m.jsx)(w,{threadID:c,loadThread:a,noRenderButton:!0,parentPostID:f.id,setRenderReplyForm:q})}()]}),L&&g.map((function(t){return null!==t?Object(m.jsx)(e,{loadThread:a,postID:t,getPost:s,threadID:c,indentLevel:o+1,newPost:_},t):null}))]})},J=n(29),U=n.n(J),L=U()("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/"),F={title:"",content:"",username:"",_id:"",posts:[],date:"1"},A=function(){var e=Object(r.useContext)(b),t=e.username,n=(e.setUsername,Object(r.useState)(F)),c=Object(i.a)(n,2),a=c[0],s=c[1],o="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",u=Object(d.h)(),h=u.communityName,p=u.id,f=Object(d.f)(),O=Object(r.useState)([]),x=Object(i.a)(O,2),k=x[0],S=x[1],C=Object(r.useState)(null),D=Object(i.a)(C,2),I=D[0],T=D[1],R=Object(i.a)(Object(r.useContext)(P).voteReload,2),E=(R[0],R[1]),J=Object(i.a)(Object(r.useContext)(P).deleteReload,2),U=(J[0],J[1]);function A(){return W.apply(this,arguments)}function W(){return(W=Object(j.a)(l.a.mark((function e(){var t,n,r,c,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"getThread/").concat(p));case 2:return t=e.sent,e.next=5,t.json();case 5:if(!(n=e.sent).hasOwnProperty("error")){e.next=9;break}return f.push("/home"),e.abrupt("return");case 9:if(JSON.stringify(n)!==JSON.stringify(a)){s(n),S([]),r=Object(v.a)(n.posts);try{for(i=function(){var e=c.value;null===e.parentID&&S((function(t){return[].concat(Object(y.a)(t),[e])}))},r.s();!(c=r.n()).done;)i()}catch(u){r.e(u)}finally{r.f()}}case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return B.apply(this,arguments)}function B(){return(B=Object(j.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"deleteThread/").concat(h,"/").concat(p));case 2:e.sent,f.push("/c/".concat(h));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){var t,n=Object(v.a)(a.posts);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.id===e)return r}}catch(c){n.e(c)}finally{n.f()}return null}return Object(r.useEffect)((function(){return A(),L.connect(),L.emit("onThread",p),L.on("newPost",(function(e){null===e.parentID?(console.log("new top level post"),S((function(t){return[].concat(Object(y.a)(t),[e])}))):T(e)})),L.on("upvotePost",(function(e){E(e)})),L.on("postDeleted",(function(e){U(e)})),function(){L.disconnect()}}),[]),Object(m.jsxs)("div",{className:"container mt-3 mb-5",children:[Object(m.jsx)("div",{className:"row",children:Object(m.jsxs)("div",{className:"col d-inline-flex align-items-center",children:[Object(m.jsx)("h1",{className:"mb-0",children:a.title}),function(){if(a.username===t)return Object(m.jsx)(g.b.Provider,{value:{size:"1em"},children:Object(m.jsx)(N.a,{onClick:_,style:{cursor:"pointer",minWidth:"15px"},className:"ml-2"})})}()]})}),Object(m.jsxs)("h6",{children:["- ",a.username]}),Object(m.jsx)("p",{style:{wordWrap:"break-word"},children:a.content}),Object(m.jsx)(w,{threadID:p,loadThread:A}),Object(m.jsx)("h4",{className:"mt-5",children:"Replies:"}),Object(m.jsx)("div",{className:"container ",children:k.map((function(e,t){return Object(m.jsx)(q,{postID:e.id,threadID:p,loadThread:A,getPost:z,indentLevel:0,newPost:I},t)}))})]})},W=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),s=Object(i.a)(a,2),u=s[0],b=s[1],h=Object(r.useState)(""),p=Object(i.a)(h,2),f=p[0],O=p[1],x=Object(r.useState)(""),y=Object(i.a)(x,2),v=y[0],g=y[1],N=Object(r.useState)(""),w=Object(i.a)(N,2),k=w[0],S=w[1],C="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",D=Object(d.f)();function I(){if(u===f)return!0}function T(){return(T=Object(j.a)(l.a.mark((function e(t){var r,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),S(""),g(""),I()){e.next=5;break}return e.abrupt("return");case 5:return r={username:n,password:u},C+"register",e.prev=7,e.next=10,fetch("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/register",{body:JSON.stringify(r),headers:{"Content-Type":"application/json"},method:"POST"});case 10:return c=e.sent,e.next=13,c.json();case 13:if(!(a=e.sent).hasOwnProperty("error")){e.next=17;break}return S(a.error),e.abrupt("return");case 17:return g(a.status),e.next=20,new Promise((function(e){return setTimeout(e,1500)}));case 20:D.push("/login"),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(7),console.log(e.t0);case 26:case"end":return e.stop()}}),e,null,[[7,23]])})))).apply(this,arguments)}return Object(m.jsx)("div",{className:"container",children:Object(m.jsx)("div",{className:"row",children:Object(m.jsxs)("div",{className:"col-12 col-sm-8 offset-sm-2 col-xl-6 offset-xl-3",children:[Object(m.jsxs)("form",{className:"mt-5",children:[Object(m.jsx)("h1",{className:"mb-4 text-center",children:"Register"}),Object(m.jsxs)("div",{className:"form-group mb-2",children:[Object(m.jsx)("label",{children:"Username"}),Object(m.jsx)("input",{type:"text",value:n,onChange:function(e){return c(e.target.value)},className:"form-control",placeholder:"Enter username"})]}),Object(m.jsxs)("div",{className:"form-group mb-2",children:[Object(m.jsx)("label",{children:"Password"}),Object(m.jsx)("input",{type:"password",value:u,onChange:function(e){return b(e.target.value)},className:"form-control",placeholder:"Enter password"})]}),Object(m.jsxs)("div",{className:"form-group mb-3",children:[Object(m.jsx)("label",{children:"Confirm Password"}),Object(m.jsx)("input",{type:"password",value:f,onChange:function(e){return O(e.target.value)},className:"form-control",placeholder:"Enter password"})]}),Object(m.jsx)("button",{type:"submit",onClick:function(e){return function(e){return T.apply(this,arguments)}(e)},className:"btn btn-primary",children:"Submit"})]}),Object(m.jsx)(o.b,{to:"/login",children:Object(m.jsx)("div",{className:"mt-1",children:"Already registered? Click here to login!"})}),v.length>0&&Object(m.jsx)("h5",{className:"mt-3 alert alert-success",children:v}),k.length>0&&Object(m.jsx)("h5",{className:"mt-3 alert alert-danger",children:k})]})})})},_=function(e){var t=e.communityName,n=Object(r.useState)(!1),c=Object(i.a)(n,2),a=c[0],s=c[1],o="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",u=Object(r.useState)(""),d=Object(i.a)(u,2),h=d[0],p=d[1],f=Object(r.useState)(""),O=Object(i.a)(f,2),x=O[0],y=O[1],v=Object(r.useContext)(b).username,g=Object(r.useState)(""),N=Object(i.a)(g,2),w=N[0],k=N[1];function S(){return h.length>5e3?(k("Exceeded content length!"),!1):x.length>150?(k("Exceeded title length!"),!1):(k(""),!0)}function C(){return D.apply(this,arguments)}function D(){return(D=Object(j.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S()){e.next=2;break}return e.abrupt("return");case 2:return n={username:v,content:h,title:x,communityName:t},e.prev=3,e.next=6,fetch(o+"newThread",{body:JSON.stringify(n),headers:{"Content-Type":"application/json"},method:"POST"});case 6:e.sent,s((function(e){return!e})),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(3);case 12:case"end":return e.stop()}}),e,null,[[3,10]])})))).apply(this,arguments)}function I(){if(0!==w.length)return Object(m.jsx)("h5",{className:"alert alert-danger mt-2",children:w})}return Object(m.jsx)("div",{className:"mb-5",children:a?Object(m.jsxs)("div",{className:"form-group mt-4",children:[Object(m.jsx)("label",{className:"",children:"Title"}),Object(m.jsx)("input",{type:"text",className:"form-control",onChange:function(e){return y(e.target.value)}}),Object(m.jsx)("label",{className:"",children:"Content"}),Object(m.jsx)("textarea",{onChange:function(e){return p(e.target.value)},className:"form-control border border-secondary"}),Object(m.jsx)("button",{onClick:C,className:"btn btn-primary mt-2",children:"Submit"}),I()]}):Object(m.jsx)("button",{className:"btn btn-primary",onClick:function(){return s((function(e){return!e}))},children:"Add Thread"})})},B=function(e){var t=e.threadID,n=e.communityName,c=(Object(d.f)(),Object(r.useState)(F)),a=Object(i.a)(c,2),s=a[0],u=a[1];return Object(r.useEffect)((function(){var e=!0;return Object(j.a)(l.a.mark((function n(){var r,c;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api//getThread/"+t);case 2:return r=n.sent,n.next=5,r.json();case 5:c=n.sent,e&&u(c);case 7:case"end":return n.stop()}}),n)})))(),function(){e=!1}}),[]),Object(m.jsx)(o.b,{to:"/c/".concat(n,"/").concat(t),children:Object(m.jsx)("div",{className:"border border-primary rounded my-2 p-2",children:Object(m.jsxs)("div",{className:"ml-2",children:[Object(m.jsxs)("small",{className:"",children:["Posted by: ",s.username," ",function(){if(s.date){var e=(new Date).getTime()-parseInt(s.date);return S()(e,{compact:!0,verbose:!0})+" ago"}}()]}),Object(m.jsx)("h4",{children:s.title}),Object(m.jsx)("p",{style:{wordWrap:"break-word"},children:s.content.length>500?s.content.substring(1,500)+"...":s.content})]})})})},z=U()("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/"),H=function(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(d.h)().communityName,s=Object(r.useState)(""),o=Object(i.a)(s,2),u=o[0],b=o[1];return Object(r.useEffect)((function(){var e=!0;return Object(j.a)(l.a.mark((function t(){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/getThreads/"+a);case 2:return n=t.sent,t.next=5,n.json();case 5:if("error"in(r=t.sent)&&b("Sorry! this page doesn't exist."),e){t.next=9;break}return t.abrupt("return");case 9:e&&c(r.threads);case 10:case"end":return t.stop()}}),t)})))(),function(){e=!1}}),[a]),Object(r.useEffect)((function(){return z.connect(),z.emit("onCommunity",a),z.on("newThread",(function(e){c((function(t){return t.includes(e._id)?t:[].concat(Object(y.a)(t),[e._id])}))})),z.on("deletedThread",(function(e){c((function(t){return t.filter((function(t){return t!==e}))}))})),function(){z.disconnect()}}),[a,n]),Object(m.jsxs)("div",{className:"container",children:[""===u&&n.map((function(e){return Object(m.jsx)(B,{threadID:e,communityName:a},e)})),function(){if(""!==u)return Object(m.jsx)("h1",{className:"alert alert-danger",children:u})}(),""===u&&Object(m.jsx)(_,{communityName:a})]})},V=(n(101),n(58)),M=n.n(V),Z=(n(102),function(e){return Object(m.jsx)("div",{className:"form-group mt-4 container-fluid d-flex justify-content-center align-items-center",id:"overlay",style:{cursor:"auto"},children:Object(m.jsx)("div",{className:"d-flex flex-column bg-secondary justify-content-center w-75 px-5 py-5",style:{minWidth:"350px",maxWidth:"750px"},children:e.children})})}),G=function(e){var t=e.addCommunity,n="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",c=Object(r.useState)(!1),a=Object(i.a)(c,2),s=a[0],o=a[1],u=Object(r.useState)(""),d=Object(i.a)(u,2),h=d[0],p=d[1],f=Object(r.useState)(""),O=Object(i.a)(f,2),x=O[0],y=O[1],v=Object(r.useContext)(b).username,g=Object(r.useState)(""),N=Object(i.a)(g,2),w=N[0],k=N[1];function S(){return C.apply(this,arguments)}function C(){return(C=Object(j.a)(l.a.mark((function e(){var r,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={admins:[],communityName:x,creatorUsername:v,date:(new Date).getTime().toString(),description:h},e.prev=1,e.next=4,fetch(n+"addCommunity",{body:JSON.stringify(r),headers:{"Content-Type":"application/json"},method:"POST"});case 4:return c=e.sent,e.next=7,c.json();case 7:if("_id"in(a=e.sent)){e.next=13;break}return k("Sorry the community name as already been taken. Please try again!"),console.log("failed"),o((function(e){return!e})),e.abrupt("return");case 13:k(""),t(a),o((function(e){return!e})),e.next=20;break;case 18:e.prev=18,e.t0=e.catch(1);case 20:case"end":return e.stop()}}),e,null,[[1,18]])})))).apply(this,arguments)}function D(){if(0!==w.length)return Object(m.jsx)("h5",{className:"alert alert-danger mt-2",children:w})}return Object(m.jsx)("div",{className:"mb-5",children:s?Object(m.jsxs)(Z,{children:[Object(m.jsx)("h3",{children:"Create a community"}),Object(m.jsx)("label",{className:"text-left mt-2",children:"Community Name"}),Object(m.jsx)("input",{type:"text",className:"form-control",onChange:function(e){return y(e.target.value)}}),Object(m.jsx)("label",{className:"mt-4 text-left",children:"Description"}),Object(m.jsx)("textarea",{className:"form-control",onChange:function(e){return p(e.target.value)},rows:8}),Object(m.jsxs)("div",{className:"d-flex justify-content-end mt-3",children:[Object(m.jsx)("button",{onClick:function(){return o((function(e){return!e}))},className:"btn btn-primary mt-2 mr-2",children:"Cancel"}),Object(m.jsx)("button",{onClick:S,className:"btn btn-outline-primary mt-2",children:"Submit"})]})]}):Object(m.jsxs)("div",{children:[Object(m.jsx)("button",{className:"btn btn-primary",onClick:function(){return o((function(e){return!e}))},children:"Add New Community"}),D()]})})},K=function(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),s=Object(i.a)(a,2),u=s[0],d=s[1],b=Object(r.useState)(""),h=Object(i.a)(b,2),p=h[0],f=h[1],O=Object(r.useState)([]),x=Object(i.a)(O,2),v=x[0],g=x[1];function N(e){if(d(e),""===e)return g(n.map((function(e){return e.communityName}))),void f("");var t=M.a.filter(e,n,{extract:function(e){return e.communityName}});g(t.map((function(e){return e.string}))),0===t.length?f("No matching communities could be found!"):f("")}return Object(r.useEffect)((function(){Object(j.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/","/getCommunities"));case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,c(n),g(n.map((function(e){return e.communityName})));case 8:case"end":return e.stop()}}),e)})))(),N("")}),[]),Object(m.jsxs)("div",{className:"container mt-5 text-center",children:[Object(m.jsx)("h1",{children:"this is main page"}),Object(m.jsx)("p",{children:"Search for a community or click on one to visit it"}),Object(m.jsx)("div",{children:Object(m.jsx)("input",{type:"text",className:"w-75",onChange:function(e){return N(e.target.value)},value:u})}),Object(m.jsx)("div",{className:"row d-flex mt-4 flex-row text-left mx-5",children:v.map((function(e){return Object(m.jsx)(o.b,{to:"/c/"+e,children:Object(m.jsx)("div",{className:"mx-2 ",children:Object(m.jsx)("h4",{children:e})})},e)}))}),function(){if(""!==p)return Object(m.jsx)("h3",{className:"alert alert-danger",children:p})}(),Object(m.jsx)(G,{addCommunity:function(e){var t={_id:e._id,communityName:e.communityName,description:e.description};f(""),d(""),c((function(e){return[].concat(Object(y.a)(e),[t])})),g([].concat(Object(y.a)(n.map((function(e){return e.communityName}))),[t.communityName]))}})]})},Q=n(59),X="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",Y=function(e){var t=e.community,n=e.setReload,c=Object(r.useState)(!1),a=Object(i.a)(c,2),s=a[0],o=a[1],u=Object(r.useState)([]),d=Object(i.a)(u,2),b=d[0],h=d[1],p=Object(r.useState)(t.description),f=Object(i.a)(p,2),O=f[0],x=f[1],v=Object(r.useState)(""),g=Object(i.a)(v,2),N=g[0],w=g[1];function k(){return S.apply(this,arguments)}function S(){return(S=Object(j.a)(l.a.mark((function e(){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={description:O,communityName:t.communityName,admins:b},e.next=3,fetch(X+"updateCommunity",{body:JSON.stringify(r),headers:{"Content-Type":"application/json"},method:"POST"});case 3:e.sent,o(!1),n((function(e){return!e}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){var e=N;""!==e&&(h((function(t){return t.includes(e)?t:[].concat(Object(y.a)(t),[e])})),w(""))}function D(){return Object(m.jsxs)("div",{children:[Object(m.jsx)("label",{className:"mt-3 text-left",children:"Admins"}),Object(m.jsx)("div",{className:"container",children:Object(m.jsx)("div",{className:"border border-secondary p-3 d-flex row",children:b.map((function(e){return Object(m.jsx)("button",{className:"rounded mx-1 btn-outline-danger",onClick:function(e){return function(e){e.preventDefault();var t=e.currentTarget.innerText;h((function(e){if(!e.includes(t))return e;var n=Object(y.a)(e),r=n.indexOf(t);return n.splice(r,1),n}))}(e)},children:e},e)}))})}),Object(m.jsx)("label",{className:"mt-3 text-left",children:"Add new admin"}),Object(m.jsxs)("div",{className:"d-flex",children:[Object(m.jsx)("input",{className:"form-control w-50",style:{minWidth:"200px"},onChange:function(e){return w(e.target.value)},value:N}),Object(m.jsx)(Q.a,{onClick:C,className:"ml-2 ",style:{cursor:"pointer"},size:47})]})]})}return Object(r.useEffect)((function(){h(t.admins),x(t.description)}),[t]),Object(m.jsxs)("div",{className:"d-flex flex-column",children:[Object(m.jsx)("h4",{children:"Admin panel"}),Object(m.jsx)("button",{className:"btn btn-primary p-1 mb-2",onClick:function(){return o((function(e){return!e}))},children:"Edit community"}),function(){if(s)return Object(m.jsxs)(Z,{children:[Object(m.jsx)("h3",{children:"Edit Community"}),Object(m.jsxs)("div",{children:[Object(m.jsx)("label",{className:"mt-3 text-left",children:"Description"}),Object(m.jsx)("textarea",{className:"form-control",onChange:function(e){return x(e.target.value)},rows:8,value:O})]}),D(),Object(m.jsxs)("div",{className:"d-flex justify-content-end mt-3",children:[Object(m.jsx)("button",{onClick:function(){return o((function(e){return!e}))},className:"btn btn-primary mt-2 mr-2",children:"Cancel"}),Object(m.jsx)("button",{onClick:k,className:"btn btn-outline-primary mt-2",children:"Save"})]})]})}()]})},$=function(){var e={_id:"",admins:[],description:"",date:"",communityName:"",creatorUsername:""},t=Object(r.useState)(""),n=Object(i.a)(t,2),c=n[0],a=n[1],s=Object(r.useContext)(b).username,u=Object(r.useState)(e),h=Object(i.a)(u,2),p=h[0],f=h[1],O=Object(r.useState)(!1),x=Object(i.a)(O,2),y=x[0],v=x[1],g=Object(d.h)();return Object(r.useEffect)((function(){var t=!0;return Object(j.a)(l.a.mark((function n(){var r,c;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/getCommunity/"+g.communityName);case 2:return r=n.sent,n.next=5,r.json();case 5:if(c=n.sent,t){n.next=8;break}return n.abrupt("return");case 8:if(!("error"in c)){n.next=12;break}return f(e),a("Error."),n.abrupt("return");case 12:f(c);case 13:case"end":return n.stop()}}),n)})))(),t&&a(g.communityName),function(){t=!1}}),[g.communityName,y]),Object(m.jsx)("div",{className:"container-fluid bg-info mb-3 d-flex",children:Object(m.jsx)("div",{className:"container py-3",children:Object(m.jsxs)("div",{className:"row",children:[Object(m.jsxs)("div",{className:"col-lg-10 d-flex justify-content-between",children:[Object(m.jsxs)(o.b,{to:"/c/".concat(c),children:[Object(m.jsx)("h3",{children:c}),Object(m.jsx)("h6",{children:p.description})]}),Object(m.jsxs)("h6",{children:["created ",function(){var e=parseInt(p.date);return new Date(e).toLocaleDateString("en-AU").toString()}()]})]}),Object(m.jsx)("div",{className:"col-lg-2",children:function(){if(p.admins.includes(s))return Object(m.jsx)(Y,{community:p,setReload:v})}()})]})})})};var ee=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),s=Object(i.a)(a,2),u=s[0],l=s[1],j=Object(r.useState)(null),h=Object(i.a)(j,2),p=h[0],y=h[1];return Object(m.jsx)(o.a,{basename:"/",children:Object(m.jsxs)(b.Provider,{value:{username:n,setUsername:c},children:[Object(m.jsx)(f,{}),Object(m.jsxs)(d.c,{children:[Object(m.jsx)(d.a,{path:"/register",children:Object(m.jsx)(W,{})}),Object(m.jsx)(d.a,{path:"/login",children:Object(m.jsx)(x,{})}),Object(m.jsx)(d.a,{path:"/c/:communityName/:id",children:Object(m.jsxs)(P.Provider,{value:{voteReload:[u,l],deleteReload:[p,y]},children:[Object(m.jsx)($,{}),Object(m.jsx)(A,{})]})}),Object(m.jsxs)(d.a,{path:"/c/:communityName",children:[Object(m.jsx)($,{}),Object(m.jsx)(H,{})]}),Object(m.jsx)(d.a,{path:"/home",children:Object(m.jsx)(K,{})}),Object(m.jsx)(d.a,{path:"/",children:Object(m.jsx)(x,{})})]}),Object(m.jsx)(O,{})]})})};s.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(ee,{})}),document.getElementById("root"))}},[[103,1,2]]]);
//# sourceMappingURL=main.b4cf894b.chunk.js.map