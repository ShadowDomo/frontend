(this.webpackJsonpfakeshop=this.webpackJsonpfakeshop||[]).push([[0],{102:function(e,t,n){},103:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n.n(r),a=n(55),s=n.n(a),i=n(3),o=n(7),u=n(4),l=n.n(u),j=n(5),b=n(6),d=Object(r.createContext)(null),m=n(1),f=function(){var e="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",t=Object(r.useContext)(d),n=t.username,c=t.setUsername,a=Object(b.f)(),s=Object(b.g)();function i(){return(i=Object(j.a)(l.a.mark((function t(){var n,r,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(n=localStorage.getItem("sessionID"))){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,fetch(e+"getUsername/"+n);case 6:return r=t.sent,t.next=9,r.json();case 9:if((i=t.sent).username||["/login","/register"].includes(s.pathname)){t.next=13;break}return a.push("/login"),t.abrupt("return");case 13:c(i.username),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(3),a.push("/login");case 19:case"end":return t.stop()}}),t,null,[[3,16]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){var e=!0;return"/"===s.pathname||"/login"===s.pathname?(localStorage.removeItem("sessionID"),a.push("/login"),void(e&&c(""))):(function(){i.apply(this,arguments)}(),function(){e=!1})}),[s.pathname]),Object(m.jsxs)("div",{children:[Object(m.jsx)("h6",{className:"text-white",children:n}),Object(m.jsxs)("div",{className:"d-flex flex-row",children:[Object(m.jsx)(o.b,{className:"mr-3",to:"/login",onClick:function(){localStorage.removeItem("sessionID"),c("")},children:n&&n.length>0?Object(m.jsx)("h5",{className:"text-primary",children:"logout"}):"/register"===s.pathname?Object(m.jsx)("h5",{children:"Login"}):void 0}),Object(m.jsx)(o.b,{to:"/register",children:function(){if("/register"!==s.pathname)return n?void 0:Object(m.jsx)("h5",{className:"font-weight-bold",children:"Register"})}()})]})]})},h=function(){return Object(m.jsxs)("div",{className:"bg-dark navbar w-100 static-top",children:[Object(m.jsx)(o.b,{to:function(){return null===localStorage.getItem("sessionID")?"#":"/home"},children:Object(m.jsx)("h1",{className:"navbar-brand mx-3 text-light",children:"Forum Clone"})}),Object(m.jsx)(f,{})]})},p=function(){return Object(m.jsx)("div",{children:Object(m.jsx)(h,{})})},O=function(){return Object(m.jsx)("div",{className:"bg-dark w-100",style:{position:"fixed",bottom:0},children:Object(m.jsx)("h6",{className:"text-light m-2",children:"Dom Zhu - 2021"})})},x=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),s=Object(i.a)(a,2),u=s[0],f=s[1],h=Object(r.useState)(""),p=Object(i.a)(h,2),O=p[0],x=p[1],y=Object(b.f)(),v=(Object(r.useContext)(d).username,Object(r.useContext)(d).setUsername),g=Object(b.g)(),N="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/";function w(){return(w=Object(j.a)(l.a.mark((function e(t){var r,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r={username:n,password:u},N+"login",e.prev=3,e.next=6,fetch("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/login",{body:JSON.stringify(r),headers:{"Content-Type":"application/json"},method:"POST"});case 6:return c=e.sent,e.next=9,c.json();case 9:if(!(a=e.sent).hasOwnProperty("error")){e.next=13;break}return x(a.error),e.abrupt("return");case 13:localStorage.setItem("sessionID",a.sessionID),v(n),y.push("/home"),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),x("Failed to login. Please try again.");case 21:case"end":return e.stop()}}),e,null,[[3,18]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){v(""),"/login"!==g.pathname&&y.push("/login")}),[g.pathname,y,v]),Object(m.jsx)("div",{className:"container",children:Object(m.jsx)("div",{className:"row",children:Object(m.jsxs)("div",{className:"col-12 col-sm-8 offset-sm-2 col-xl-6 offset-xl-3",children:[Object(m.jsxs)("form",{className:"mt-5",children:[Object(m.jsx)("h1",{className:"mb-4 text-center",children:"Login"}),Object(m.jsxs)("div",{className:"form-group mb-2",children:[Object(m.jsx)("label",{children:"Username"}),Object(m.jsx)("input",{type:"text",value:n,onChange:function(e){return c(e.target.value)},className:"form-control",placeholder:"Enter username"})]}),Object(m.jsxs)("div",{className:"form-group mb-3",children:[Object(m.jsx)("label",{children:"Password"}),Object(m.jsx)("input",{type:"password",value:u,onChange:function(e){return f(e.target.value)},className:"form-control",placeholder:"Enter password"})]}),Object(m.jsx)("button",{type:"submit",onClick:function(e){return w.apply(this,arguments)},className:"btn btn-primary",children:"Submit"})]}),Object(m.jsx)(o.b,{to:"/register",children:Object(m.jsx)("div",{className:"mt-1",children:"New user? Click here to register!"})}),O.length>0&&Object(m.jsx)("h5",{className:"mt-3 alert alert-danger",children:O})]})})})},y=n(9),v=n(37),g=n(0),N=n(58),w=function(e){var t=e.threadID,n=(e.loadThread,e.noRenderButton),c=e.parentPostID,a=e.setRenderReplyForm,s=Object(r.useState)(!1),o=Object(i.a)(s,2),u=o[0],b=o[1],f="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",h=Object(r.useState)(""),p=Object(i.a)(h,2),O=p[0],x=p[1],y=Object(r.useContext)(d).username,v=Object(r.useState)(""),g=Object(i.a)(v,2),N=g[0],w=g[1];function k(){return S.apply(this,arguments)}function S(){return(S=Object(j.a)(l.a.mark((function e(){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={username:y,content:O,date:(new Date).getTime().toString(),threadID:t,childrenIDs:[],parentID:c,imageURL:N},e.prev=1,e.next=4,fetch(f+"makePost",{body:JSON.stringify(n),headers:{"Content-Type":"application/json"},method:"POST"});case 4:return r=e.sent,e.next=7,r.json();case 7:e.sent,b((function(e){return!e})),x(""),w(""),e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(1),e.abrupt("return");case 16:C();case 17:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function C(){b(!1),a&&a(!1)}return Object(r.useEffect)((function(){b(void 0!==n)}),[]),Object(m.jsxs)(m.Fragment,{children:[u&&Object(m.jsxs)("div",{className:"form-group mt-4 mb-5",children:[Object(m.jsx)("label",{className:"",children:"Content"}),Object(m.jsx)("textarea",{value:O,placeholder:"What are your thoughts?",onChange:function(e){return x(e.target.value)},className:"form-control border border-secondary",rows:6}),Object(m.jsxs)("div",{className:"mt-3",children:[Object(m.jsx)("label",{children:"Image url"}),Object(m.jsx)("input",{value:N,type:"text",onChange:function(e){return w(e.target.value)},className:"form-control border border-secondary"})]}),Object(m.jsxs)("div",{className:"d-flex flex-row justify-content-end",children:[Object(m.jsx)("button",{onClick:function(e){return C()},className:"btn btn-primary mt-2",children:"Cancel"}),Object(m.jsx)("button",{onClick:k,className:"btn btn-primary mt-2 ml-3 bg-secondary text-dark border border-secondary",children:"Submit"})]})]}),!u&&!n&&Object(m.jsx)("div",{children:Object(m.jsx)("button",{className:"btn btn-primary",onClick:function(){return b((function(e){return!e}))},children:"Add Reply"})})]})},k=n(28),S=n.n(k),C=function(e){var t=e.post,n=Object(r.useState)(0),c=Object(i.a)(n,2),a=c[0],s=c[1];return Object(r.useEffect)((function(){var e=setInterval((function(){var e=(new Date).getTime()-parseInt(t.date);s(e)}),100);return function(){clearTimeout(e)}}),[t.date]),Object(m.jsxs)("div",{className:"row p-2 d-flex justify-content-between",children:[Object(m.jsx)("h6",{className:"text-white ml-1",children:t.username}),Object(m.jsx)("h6",{children:"1"!==t.date&&Object(m.jsxs)("small",{className:"ml-3 text-muted",children:[S()(a,{compact:!0})," ago"]})})]})},D=Object(r.createContext)(null),I=function(e){var t=e.post,n=e.renderChildren,c=e.setRenderReplyForm,a=e.setRenderChildren,s=e.deletePost,i=Object(r.useContext)(d).username,o="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",u=Object(r.useContext)(D);function b(){return(b=Object(j.a)(l.a.mark((function e(){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(o+"hidePost",{body:JSON.stringify({username:i,postID:t.id,hidden:n}),headers:{"Content-Type":"application/json"},method:"POST"});case 2:return r=e.sent,e.next=5,r.json();case 5:e.sent;case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){a((function(e){return!e})),function(){b.apply(this,arguments)}()}return Object(m.jsx)("div",{className:"row",children:Object(m.jsxs)("div",{className:"col d-flex",children:[Object(m.jsx)("div",{children:Object(m.jsx)("h6",{className:"text-muted",children:Object(m.jsx)("small",{style:{cursor:"pointer"},onClick:function(e){return c((function(e){return!e}))},children:"Reply"})})}),0===t.childrenIDs.length?null:Object(m.jsx)("div",{className:"ml-3",children:Object(m.jsx)("h6",{className:"text-muted",children:Object(m.jsxs)("small",{style:{cursor:"pointer"},onClick:function(e){return f()},children:[!n&&"Show Replies",n&&"Hide Replies"]})})}),function(){if(!t.deleted&&(t.username===i||u.admins.includes(i)))return Object(m.jsx)("div",{className:"ml-3",children:Object(m.jsx)("h6",{className:"text-muted",children:Object(m.jsx)("small",{style:{cursor:"pointer"},onClick:function(e){return s()},children:"Delete Post"})})})}()]})})},T=function(e){var t=e.post;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{className:"row pl-2",children:Object(m.jsx)("div",{className:"text-white ml-1",children:t.deleted?Object(m.jsx)("h6",{className:"text-danger",children:"[Deleted]"}):Object(m.jsx)("p",{style:{wordBreak:"break-word"},children:t.content})})}),function(){if(!t.deleted)return""!==t.imageURL?Object(m.jsx)("img",{className:"mb-2",style:{maxWidth:"400px",width:"100%",height:"auto"},src:t.imageURL,alt:""}):void 0}()]})},P=n(25),R=Object(r.createContext)(null),E=function(e){var t=e.postID,n=e.username,c=Object(r.useState)(0),a=Object(i.a)(c,2),s=a[0],o=a[1],u="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",b=Object(r.useState)(0),d=Object(i.a)(b,2),f=d[0],h=d[1],p=Object(r.useContext)(R).voteReload,O=Object(i.a)(p,2),x=O[0],y=O[1];function v(){return N.apply(this,arguments)}function N(){return(N=Object(j.a)(l.a.mark((function e(){var r,c,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,fetch(u+"getPostVotes",{body:JSON.stringify({postID:t}),headers:{"Content-Type":"application/json"},method:"POST"});case 4:return r=e.sent,e.next=7,r.json();case 7:return c=e.sent,o(parseInt(c.votes)),e.next=11,fetch(u+"getUsersVotes",{body:JSON.stringify({postID:t,username:n}),headers:{"Content-Type":"application/json"},method:"POST"});case 11:return a=e.sent,e.next=14,a.json();case 14:s=e.sent,h(s.vote);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return k.apply(this,arguments)}function k(){return(k=Object(j.a)(l.a.mark((function e(r){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c={postID:t,vote:r,username:n},fetch(u+"upvotePost",{body:JSON.stringify(c),headers:{"Content-Type":"application/json"},method:"POST"});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){var e=!0;return e&&x===t&&(v(),y(null)),function(){e=!1}}),[x]),Object(r.useEffect)((function(){v()}),[n]),Object(m.jsx)("div",{className:"d-flex flex-column mx-2",children:Object(m.jsxs)(g.b.Provider,{value:{size:"2em"},children:[1===f&&Object(m.jsx)(P.b,{style:{cursor:"pointer",color:"orange"},onClick:function(e){return w("1")}}),1!==f&&Object(m.jsx)(P.b,{style:{cursor:"pointer"},onClick:function(e){return w("1")}}),Object(m.jsx)("h5",{className:"text-white text-center",style:{marginBottom:"0"},children:s}),-1===f&&Object(m.jsx)(P.a,{style:{cursor:"pointer",color:"blue"},onClick:function(e){return w("-1")}}),-1!==f&&Object(m.jsx)(P.a,{style:{cursor:"pointer"},onClick:function(e){return w("-1")}})]})})},q="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",J=function e(t){var n=t.postID,c=t.threadID,a=t.loadThread,s=t.getPost,o=t.indentLevel,u=t.newPost,b=Object(r.useContext)(d).username,f=Object(r.useState)({childrenIDs:[],content:"loading...",date:"1",id:"",imageURL:"",parentID:"",username:"loading..."}),h=Object(i.a)(f,2),p=h[0],O=h[1],x=Object(r.useState)([]),v=Object(i.a)(x,2),g=v[0],N=v[1],k=Object(r.useState)(!1),S=Object(i.a)(k,2),D=S[0],P=S[1],J=Object(r.useState)(!0),U=Object(i.a)(J,2),L=U[0],F=U[1],A=Object(r.useState)(u),W=Object(i.a)(A,2),_=W[0],B=W[1],z=Object(i.a)(Object(r.useContext)(R).deleteReload,2),H=z[0],V=z[1],M=20*o;function Z(e){return G.apply(this,arguments)}function G(){return(G=Object(j.a)(l.a.mark((function e(t){var n,r,a,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={threadID:c,postID:t},e.next=3,fetch(q+"getPost",{body:JSON.stringify(n),headers:{"Content-Type":"application/json"},method:"POST"});case 3:return r=e.sent,e.next=6,r.json();case 6:return a=e.sent,e.next=9,fetch(q+"isPostHidden",{body:JSON.stringify({username:b,postID:t}),headers:{"Content-Type":"application/json"},method:"POST"});case 9:return s=e.sent,e.next=12,s.json();case 12:return i=e.sent,F(!i.status),e.abrupt("return",a);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){return(K=Object(j.a)(l.a.mark((function e(){var t,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={threadID:c,postID:n},e.prev=1,e.next=4,fetch(q+"deletePost",{body:JSON.stringify(t),headers:{"Content-Type":"application/json"},method:"POST"});case 4:return r=e.sent,e.next=7,r.json();case 7:if(!e.sent.hasOwnProperty("status")){e.next=13;break}return e.next=11,Z(n);case 11:a=e.sent,O(a);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){var e=!0;return function(){var t=Object(j.a)(l.a.mark((function t(){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Z(n);case 2:r=t.sent,e&&(O(r),N(r.childrenIDs));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()(),function(){e=!1}}),[]),Object(r.useEffect)((function(){if(H===n){var e=p;e.deleted=!0,O(e),V(null)}}),[H]),Object(r.useEffect)((function(){if(null!==u){if(u.parentID===n){N((function(e){return[].concat(Object(y.a)(e),[u.id])}));var e=p;return e.childrenIDs=[].concat(Object(y.a)(p.childrenIDs),[u.id]),O(e),void B(null)}B(u)}}),[u]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{style:{marginLeft:M,width:"auto"},children:[Object(m.jsxs)("div",{className:"my-3 d-flex border border-secondary rounded bg-dark",children:[Object(m.jsx)(E,{postID:n,username:b}),Object(m.jsxs)("div",{className:"container",style:{paddingLeft:"0"},children:[Object(m.jsx)(C,{post:p}),Object(m.jsx)(T,{post:p}),Object(m.jsx)(I,{post:p,renderChildren:L,setRenderReplyForm:P,setRenderChildren:F,deletePost:function(){return K.apply(this,arguments)}})]})]}),function(){if(D)return Object(m.jsx)(w,{threadID:c,loadThread:a,noRenderButton:!0,parentPostID:p.id,setRenderReplyForm:P})}()]}),L&&g.map((function(t){return null!==t?Object(m.jsx)(e,{loadThread:a,postID:t,getPost:s,threadID:c,indentLevel:o+1,newPost:_},t):null}))]})},U=(n(71),function(e){return Object(m.jsx)("div",{className:"form-group mt-4 container-fluid d-flex justify-content-center align-items-center",id:"overlay",style:{cursor:"auto"},children:Object(m.jsx)("div",{className:"d-flex flex-column bg-secondary justify-content-center w-75 px-5 py-5",style:{minWidth:"350px",maxWidth:"750px"},children:e.children})})}),L=n(57),F="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",A=function(e){var t=e.community,n=e.setReload,c=Object(r.useState)(!1),a=Object(i.a)(c,2),s=a[0],o=a[1],u=Object(r.useState)([]),b=Object(i.a)(u,2),d=b[0],f=b[1],h=Object(r.useState)(t.description),p=Object(i.a)(h,2),O=p[0],x=p[1],v=Object(r.useState)(""),g=Object(i.a)(v,2),N=g[0],w=g[1];function k(){return S.apply(this,arguments)}function S(){return(S=Object(j.a)(l.a.mark((function e(){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={description:O,communityName:t.communityName,admins:d},e.next=3,fetch(F+"updateCommunity",{body:JSON.stringify(r),headers:{"Content-Type":"application/json"},method:"POST"});case 3:e.sent,o(!1),n((function(e){return!e}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){var e=N;""!==e&&(f((function(t){return t.includes(e)?t:[].concat(Object(y.a)(t),[e])})),w(""))}function D(){return Object(m.jsxs)("div",{children:[Object(m.jsx)("label",{className:"mt-3 text-left",children:"Admins"}),Object(m.jsx)("div",{className:"container",children:Object(m.jsx)("div",{className:"border border-secondary p-3 d-flex row",children:d.map((function(e){return Object(m.jsx)("button",{className:"rounded mx-1 btn-outline-danger",onClick:function(e){return function(e){e.preventDefault();var t=e.currentTarget.innerText;f((function(e){if(!e.includes(t))return e;var n=Object(y.a)(e),r=n.indexOf(t);return n.splice(r,1),n}))}(e)},children:e},e)}))})}),Object(m.jsx)("label",{className:"mt-3 text-left",children:"Add new admin"}),Object(m.jsxs)("div",{className:"d-flex",children:[Object(m.jsx)("input",{className:"form-control w-50",style:{minWidth:"200px"},onChange:function(e){return w(e.target.value)},value:N}),Object(m.jsx)(L.a,{onClick:C,className:"ml-2 ",style:{cursor:"pointer"},size:47})]})]})}return Object(r.useEffect)((function(){f(t.admins),x(t.description)}),[t]),Object(m.jsxs)("div",{className:"d-flex flex-column",children:[Object(m.jsx)("h4",{children:"Admin panel"}),Object(m.jsx)("button",{className:"btn btn-primary p-1 mb-2",onClick:function(){return o((function(e){return!e}))},children:"Edit community"}),function(){if(s)return Object(m.jsxs)(U,{children:[Object(m.jsx)("h3",{children:"Edit Community"}),Object(m.jsxs)("div",{children:[Object(m.jsx)("label",{className:"mt-3 text-left",children:"Description"}),Object(m.jsx)("textarea",{className:"form-control",onChange:function(e){return x(e.target.value)},rows:8,value:O})]}),D(),Object(m.jsxs)("div",{className:"d-flex justify-content-end mt-3",children:[Object(m.jsx)("button",{onClick:function(){return o((function(e){return!e}))},className:"btn btn-primary mt-2 mr-2",children:"Cancel"}),Object(m.jsx)("button",{onClick:k,className:"btn btn-outline-primary mt-2",children:"Save"})]})]})}()]})},W={_id:"",admins:[],description:"",date:"",communityName:"",creatorUsername:""},_=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useContext)(d).username,s=Object(r.useState)(W),u=Object(i.a)(s,2),f=u[0],h=u[1],p=Object(r.useState)(!1),O=Object(i.a)(p,2),x=O[0],y=O[1],v=Object(b.h)();return Object(r.useEffect)((function(){var e=!0;return Object(j.a)(l.a.mark((function t(){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/getCommunity/"+v.communityName);case 2:return n=t.sent,t.next=5,n.json();case 5:if(r=t.sent,e){t.next=8;break}return t.abrupt("return");case 8:if(!("error"in r)){t.next=12;break}return h(W),c("Error."),t.abrupt("return");case 12:h(r);case 13:case"end":return t.stop()}}),t)})))(),e&&c(v.communityName),function(){e=!1}}),[v.communityName,x]),Object(m.jsx)("div",{className:"container-fluid bg-info mb-3 d-flex",children:Object(m.jsx)("div",{className:"container py-3",children:Object(m.jsxs)("div",{className:"row",children:[Object(m.jsxs)("div",{className:"col-lg-10 d-flex justify-content-between",children:[Object(m.jsxs)(o.b,{to:"/c/".concat(n),children:[Object(m.jsx)("h3",{children:n}),Object(m.jsx)("h6",{children:f.description})]}),Object(m.jsxs)("h6",{children:["created ",function(){var e=parseInt(f.date);return new Date(e).toLocaleDateString("en-AU").toString()}()]})]}),Object(m.jsx)("div",{className:"col-lg-2",children:function(){if(f.admins.includes(a))return Object(m.jsx)(A,{community:f,setReload:y})}()})]})})})},B=n(29),z=n.n(B),H=z()("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/"),V={title:"",content:"",username:"",_id:"",posts:[],date:"1"},M=function(){var e=Object(r.useContext)(d),t=e.username,n=(e.setUsername,Object(r.useState)(V)),c=Object(i.a)(n,2),a=c[0],s=c[1],o=Object(r.useState)(W),u=Object(i.a)(o,2),f=u[0],h=u[1],p="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",O=Object(b.h)(),x=O.communityName,k=O.id,S=Object(b.f)(),C=Object(r.useState)([]),I=Object(i.a)(C,2),T=I[0],P=I[1],E=Object(r.useState)(null),q=Object(i.a)(E,2),U=q[0],L=q[1],F=Object(i.a)(Object(r.useContext)(R).voteReload,2),A=(F[0],F[1]),_=Object(i.a)(Object(r.useContext)(R).deleteReload,2),B=(_[0],_[1]);function z(){return M.apply(this,arguments)}function M(){return(M=Object(j.a)(l.a.mark((function e(){var t,n,r,c,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"getThread/").concat(k));case 2:return t=e.sent,e.next=5,t.json();case 5:if(!(n=e.sent).hasOwnProperty("error")){e.next=9;break}return S.push("/home"),e.abrupt("return");case 9:if(JSON.stringify(n)!==JSON.stringify(a)){s(n),P([]),r=Object(v.a)(n.posts);try{for(i=function(){var e=c.value;null===e.parentID&&P((function(t){return[].concat(Object(y.a)(t),[e])}))},r.s();!(c=r.n()).done;)i()}catch(o){r.e(o)}finally{r.f()}}case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(){return G.apply(this,arguments)}function G(){return(G=Object(j.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"deleteThread/").concat(x,"/").concat(k));case 2:e.sent,S.push("/c/".concat(x));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e){var t,n=Object(v.a)(a.posts);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.id===e)return r}}catch(c){n.e(c)}finally{n.f()}return null}return Object(r.useEffect)((function(){var e=!0;return Object(j.a)(l.a.mark((function t(){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(p+"getCommunity/"+x);case 2:return n=t.sent,t.next=5,n.json();case 5:if(r=t.sent,e){t.next=8;break}return t.abrupt("return");case 8:if(!("error"in r)){t.next=11;break}return h(W),t.abrupt("return");case 11:h(r);case 12:case"end":return t.stop()}}),t)})))(),function(){e=!1}}),[x]),Object(r.useEffect)((function(){var e=!0;return z(),e&&(H.connect(),H.emit("onThread",k),H.on("newPost",(function(e){null===e.parentID?(console.log("new top level post"),P((function(t){return[].concat(Object(y.a)(t),[e])}))):L(e)})),H.on("upvotePost",(function(e){A(e)})),H.on("postDeleted",(function(e){B(e)}))),function(){e=!1,H.disconnect()}}),[]),Object(m.jsx)(D.Provider,{value:f,children:Object(m.jsxs)("div",{className:"container mt-3 mb-5",children:[Object(m.jsxs)("div",{className:"container",children:[Object(m.jsx)("div",{className:"row",children:Object(m.jsxs)("div",{className:"col d-inline-flex align-items-center",children:[Object(m.jsx)("h1",{className:"mb-0",children:a.title}),function(){if(a.username===t||f.admins.includes(t))return Object(m.jsx)(g.b.Provider,{value:{size:"1em"},children:Object(m.jsx)(N.a,{onClick:Z,style:{cursor:"pointer",minWidth:"15px"},className:"ml-2"})})}()]})}),Object(m.jsxs)("h6",{children:["- ",a.username]}),Object(m.jsx)("p",{style:{wordWrap:"break-word"},children:a.content}),Object(m.jsx)(w,{threadID:k,loadThread:z})]}),Object(m.jsx)("h4",{className:"mt-5",children:"Replies:"}),Object(m.jsx)("div",{className:"container ",children:T.map((function(e,t){return Object(m.jsx)(J,{postID:e.id,threadID:k,loadThread:z,getPost:K,indentLevel:0,newPost:U},t)}))})]})})},Z=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),s=Object(i.a)(a,2),u=s[0],d=s[1],f=Object(r.useState)(""),h=Object(i.a)(f,2),p=h[0],O=h[1],x=Object(r.useState)(""),y=Object(i.a)(x,2),v=y[0],g=y[1],N=Object(r.useState)(""),w=Object(i.a)(N,2),k=w[0],S=w[1],C="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",D=Object(b.f)();function I(){if(u===p)return!0}function T(){return(T=Object(j.a)(l.a.mark((function e(t){var r,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),S(""),g(""),I()){e.next=5;break}return e.abrupt("return");case 5:return r={username:n,password:u},C+"register",e.prev=7,e.next=10,fetch("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/register",{body:JSON.stringify(r),headers:{"Content-Type":"application/json"},method:"POST"});case 10:return c=e.sent,e.next=13,c.json();case 13:if(!(a=e.sent).hasOwnProperty("error")){e.next=17;break}return S(a.error),e.abrupt("return");case 17:return g(a.status),e.next=20,new Promise((function(e){return setTimeout(e,1500)}));case 20:D.push("/login"),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(7),console.log(e.t0);case 26:case"end":return e.stop()}}),e,null,[[7,23]])})))).apply(this,arguments)}return Object(m.jsx)("div",{className:"container",children:Object(m.jsx)("div",{className:"row",children:Object(m.jsxs)("div",{className:"col-12 col-sm-8 offset-sm-2 col-xl-6 offset-xl-3",children:[Object(m.jsxs)("form",{className:"mt-5",children:[Object(m.jsx)("h1",{className:"mb-4 text-center",children:"Register"}),Object(m.jsxs)("div",{className:"form-group mb-2",children:[Object(m.jsx)("label",{children:"Username"}),Object(m.jsx)("input",{type:"text",value:n,onChange:function(e){return c(e.target.value)},className:"form-control",placeholder:"Enter username"})]}),Object(m.jsxs)("div",{className:"form-group mb-2",children:[Object(m.jsx)("label",{children:"Password"}),Object(m.jsx)("input",{type:"password",value:u,onChange:function(e){return d(e.target.value)},className:"form-control",placeholder:"Enter password"})]}),Object(m.jsxs)("div",{className:"form-group mb-3",children:[Object(m.jsx)("label",{children:"Confirm Password"}),Object(m.jsx)("input",{type:"password",value:p,onChange:function(e){return O(e.target.value)},className:"form-control",placeholder:"Enter password"})]}),Object(m.jsx)("button",{type:"submit",onClick:function(e){return function(e){return T.apply(this,arguments)}(e)},className:"btn btn-primary",children:"Submit"})]}),Object(m.jsx)(o.b,{to:"/login",children:Object(m.jsx)("div",{className:"mt-1",children:"Already registered? Click here to login!"})}),v.length>0&&Object(m.jsx)("h5",{className:"mt-3 alert alert-success",children:v}),k.length>0&&Object(m.jsx)("h5",{className:"mt-3 alert alert-danger",children:k})]})})})},G=function(e){var t=e.communityName,n=Object(r.useState)(!1),c=Object(i.a)(n,2),a=c[0],s=c[1],o="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",u=Object(r.useState)(""),b=Object(i.a)(u,2),f=b[0],h=b[1],p=Object(r.useState)(""),O=Object(i.a)(p,2),x=O[0],y=O[1],v=Object(r.useContext)(d).username,g=Object(r.useState)(""),N=Object(i.a)(g,2),w=N[0],k=N[1];function S(){return f.length>5e3?(k("Exceeded content length!"),!1):x.length>150?(k("Exceeded title length!"),!1):(k(""),!0)}function C(){return D.apply(this,arguments)}function D(){return(D=Object(j.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S()){e.next=2;break}return e.abrupt("return");case 2:return n={username:v,content:f,title:x,communityName:t},e.prev=3,e.next=6,fetch(o+"newThread",{body:JSON.stringify(n),headers:{"Content-Type":"application/json"},method:"POST"});case 6:e.sent,s((function(e){return!e})),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(3);case 12:case"end":return e.stop()}}),e,null,[[3,10]])})))).apply(this,arguments)}function I(){if(0!==w.length)return Object(m.jsx)("h5",{className:"alert alert-danger mt-2",children:w})}return Object(m.jsx)("div",{className:"mb-5",children:a?Object(m.jsxs)("div",{className:"form-group mt-4",children:[Object(m.jsx)("label",{className:"",children:"Title"}),Object(m.jsx)("input",{type:"text",className:"form-control",onChange:function(e){return y(e.target.value)}}),Object(m.jsx)("label",{className:"",children:"Content"}),Object(m.jsx)("textarea",{onChange:function(e){return h(e.target.value)},className:"form-control border border-secondary"}),Object(m.jsx)("button",{onClick:C,className:"btn btn-primary mt-2",children:"Submit"}),I()]}):Object(m.jsx)("button",{className:"btn btn-primary",onClick:function(){return s((function(e){return!e}))},children:"Add Thread"})})},K=function(e){var t=e.threadID,n=e.communityName,c=(Object(b.f)(),Object(r.useState)(V)),a=Object(i.a)(c,2),s=a[0],u=a[1],d=Object(r.useState)(0),f=Object(i.a)(d,2),h=f[0],p=f[1];return Object(r.useEffect)((function(){var e=setInterval((function(){var e=(new Date).getTime()-parseInt(s.date);p(e)}),100);return function(){clearTimeout(e)}}),[s.date]),Object(r.useEffect)((function(){var e=!0;return Object(j.a)(l.a.mark((function n(){var r,c;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api//getThread/"+t);case 2:return r=n.sent,n.next=5,r.json();case 5:c=n.sent,e&&u(c);case 7:case"end":return n.stop()}}),n)})))(),function(){e=!1}}),[]),Object(m.jsx)(o.b,{to:"/c/".concat(n,"/").concat(t),children:Object(m.jsx)("div",{className:"border border-primary rounded my-2 p-2",children:Object(m.jsxs)("div",{className:"ml-2",children:[Object(m.jsxs)("small",{className:"",children:["Posted by: ",s.username," ",function(){if(s.date)return S()(h,{compact:!0,verbose:!0})+" ago"}()]}),Object(m.jsx)("h4",{children:s.title}),Object(m.jsx)("p",{style:{wordWrap:"break-word"},children:s.content.length>500?s.content.substring(1,500)+"...":s.content})]})})})},Q=z()("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/"),X=function(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(b.h)().communityName,s=Object(r.useState)(""),o=Object(i.a)(s,2),u=o[0],d=o[1];return Object(r.useEffect)((function(){var e=!0;return Object(j.a)(l.a.mark((function t(){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/getThreads/"+a);case 2:return n=t.sent,t.next=5,n.json();case 5:if(!("error"in(r=t.sent))){t.next=9;break}return d("Sorry! this page doesn't exist."),t.abrupt("return");case 9:if(e){t.next=11;break}return t.abrupt("return");case 11:e&&(d(""),c(r.threads));case 12:case"end":return t.stop()}}),t)})))(),function(){e=!1}}),[a]),Object(r.useEffect)((function(){return Q.connect(),Q.emit("onCommunity",a),Q.on("newThread",(function(e){c((function(t){return t.includes(e._id)?t:[].concat(Object(y.a)(t),[e._id])}))})),Q.on("deletedThread",(function(e){c((function(t){return t.filter((function(t){return t!==e}))}))})),function(){Q.disconnect()}}),[a,n]),Object(m.jsxs)("div",{className:"container",children:[""===u&&n.map((function(e){return Object(m.jsx)(K,{threadID:e,communityName:a},e)})),function(){if(""!==u)return Object(m.jsx)("h1",{className:"alert alert-danger",children:u})}(),""===u&&Object(m.jsx)(G,{communityName:a})]})},Y=(n(102),n(59)),$=n.n(Y),ee=function(e){var t=e.addCommunity,n="http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/",c=Object(r.useState)(!1),a=Object(i.a)(c,2),s=a[0],o=a[1],u=Object(r.useState)(""),b=Object(i.a)(u,2),f=b[0],h=b[1],p=Object(r.useState)(""),O=Object(i.a)(p,2),x=O[0],y=O[1],v=Object(r.useContext)(d).username,g=Object(r.useState)(""),N=Object(i.a)(g,2),w=N[0],k=N[1];function S(){return C.apply(this,arguments)}function C(){return(C=Object(j.a)(l.a.mark((function e(){var r,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={admins:[],communityName:x,creatorUsername:v,date:(new Date).getTime().toString(),description:f},e.prev=1,e.next=4,fetch(n+"addCommunity",{body:JSON.stringify(r),headers:{"Content-Type":"application/json"},method:"POST"});case 4:return c=e.sent,e.next=7,c.json();case 7:if("_id"in(a=e.sent)){e.next=13;break}return k("Sorry the community name as already been taken. Please try again!"),console.log("failed"),o((function(e){return!e})),e.abrupt("return");case 13:k(""),t(a),o((function(e){return!e})),e.next=20;break;case 18:e.prev=18,e.t0=e.catch(1);case 20:case"end":return e.stop()}}),e,null,[[1,18]])})))).apply(this,arguments)}function D(){if(0!==w.length)return Object(m.jsx)("h5",{className:"alert alert-danger mt-2",children:w})}return Object(m.jsx)("div",{className:"mb-5",children:s?Object(m.jsxs)(U,{children:[Object(m.jsx)("h3",{children:"Create a community"}),Object(m.jsx)("label",{className:"text-left mt-2",children:"Community Name"}),Object(m.jsx)("input",{type:"text",className:"form-control",onChange:function(e){return y(e.target.value)}}),Object(m.jsx)("label",{className:"mt-4 text-left",children:"Description"}),Object(m.jsx)("textarea",{className:"form-control",onChange:function(e){return h(e.target.value)},rows:8}),Object(m.jsxs)("div",{className:"d-flex justify-content-end mt-3",children:[Object(m.jsx)("button",{onClick:function(){return o((function(e){return!e}))},className:"btn btn-primary mt-2 mr-2",children:"Cancel"}),Object(m.jsx)("button",{onClick:S,className:"btn btn-outline-primary mt-2",children:"Submit"})]})]}):Object(m.jsxs)("div",{children:[Object(m.jsx)("button",{className:"btn btn-primary",onClick:function(){return o((function(e){return!e}))},children:"Add New Community"}),D()]})})},te=function(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),s=Object(i.a)(a,2),u=s[0],b=s[1],d=Object(r.useState)(""),f=Object(i.a)(d,2),h=f[0],p=f[1],O=Object(r.useState)([]),x=Object(i.a)(O,2),v=x[0],g=x[1];function N(e){if(b(e),""===e)return g(n.map((function(e){return e.communityName}))),void p("");var t=$.a.filter(e,n,{extract:function(e){return e.communityName}});g(t.map((function(e){return e.string}))),0===t.length?p("No matching communities could be found!"):p("")}return Object(r.useEffect)((function(){Object(j.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://syndeyforum-env.eba-f4xyppqy.ap-southeast-2.elasticbeanstalk.com/api/","/getCommunities"));case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,c(n),g(n.map((function(e){return e.communityName})));case 8:case"end":return e.stop()}}),e)})))(),N("")}),[]),Object(m.jsxs)("div",{className:"container mt-5 text-center",children:[Object(m.jsx)("h1",{children:"this is main page"}),Object(m.jsx)("p",{children:"Search for a community or click on one to visit it"}),Object(m.jsx)("div",{children:Object(m.jsx)("input",{type:"text",className:"w-75",onChange:function(e){return N(e.target.value)},value:u})}),Object(m.jsx)("div",{className:"row d-flex mt-4 flex-row text-left mx-5",children:v.map((function(e){return Object(m.jsx)(o.b,{to:"/c/"+e,children:Object(m.jsx)("div",{className:"mx-2 ",children:Object(m.jsx)("h4",{children:e})})},e)}))}),function(){if(""!==h)return Object(m.jsx)("h3",{className:"alert alert-danger",children:h})}(),Object(m.jsx)(ee,{addCommunity:function(e){var t={_id:e._id,communityName:e.communityName,description:e.description};p(""),b(""),c((function(e){return[].concat(Object(y.a)(e),[t])})),g([].concat(Object(y.a)(n.map((function(e){return e.communityName}))),[t.communityName]))}})]})};var ne=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),s=Object(i.a)(a,2),u=s[0],l=s[1],j=Object(r.useState)(null),f=Object(i.a)(j,2),h=f[0],y=f[1];return Object(m.jsx)(o.a,{basename:"/",children:Object(m.jsxs)(d.Provider,{value:{username:n,setUsername:c},children:[Object(m.jsx)(p,{}),Object(m.jsxs)(b.c,{children:[Object(m.jsx)(b.a,{path:"/register",children:Object(m.jsx)(Z,{})}),Object(m.jsx)(b.a,{path:"/login",children:Object(m.jsx)(x,{})}),Object(m.jsx)(b.a,{path:"/c/:communityName/:id",children:Object(m.jsxs)(R.Provider,{value:{voteReload:[u,l],deleteReload:[h,y]},children:[Object(m.jsx)(_,{}),Object(m.jsx)(M,{})]})}),Object(m.jsxs)(b.a,{path:"/c/:communityName",children:[Object(m.jsx)(_,{}),Object(m.jsx)(X,{})]}),Object(m.jsx)(b.a,{path:"/home",children:Object(m.jsx)(te,{})}),Object(m.jsx)(b.a,{path:"/",children:Object(m.jsx)(x,{})})]}),Object(m.jsx)(O,{})]})})};s.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(ne,{})}),document.getElementById("root"))},71:function(e,t,n){}},[[103,1,2]]]);
//# sourceMappingURL=main.861b1946.chunk.js.map